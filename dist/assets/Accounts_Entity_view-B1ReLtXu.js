import{a as p}from"./apiService-Bs_XDTQg.js";import{d as ft,u as vt,y as w,r as o,o as H,w as bt,a4 as J,s as yt,e as i,q as l,f as e,h as f,n as B,t as a,b as g,v as E,i as K,F as O,C as R,m as W}from"./index-DKsQNwYd.js";const pt=ft({name:"Accounts_Entity_view",setup(){const t=vt(),u=w(()=>t.language==="ar"),P=o(!1);H(()=>{P.value=t.darkMode}),bt(()=>t.darkMode,n=>{P.value=n});const d=(n,r="success")=>{r==="error"?console.error(n):console.log(n),alert(n)},z=o("accounts"),h=o([]),s=o([]),v=o([]),C=o([]),M=o(!1),S=o(!1),k=8,D=o(1),$=o(1),X=w(()=>Math.ceil(v.value.length/k)),Y=w(()=>Math.ceil(C.value.length/k)),Z=w(()=>{const n=(D.value-1)*k,r=n+k;return v.value.slice(n,r)}),_=w(()=>{const n=($.value-1)*k,r=n+k;return C.value.slice(n,r)}),L=o(""),T=o(""),V=o(!1),I=o(!1),F=o(!1),m=o(!1),b=o(null),y=o(null),U=o(""),q=o(""),c=J({account:"",parent:"",alias_default:""}),A=J({entity:"",parent:"",alias_default:""}),N=async()=>{M.value=!0;try{const n=await p.accountEntities.getAccounts();h.value=n.data||[],v.value=[...h.value],D.value=1}catch(n){console.error("Error fetching accounts:",n),d(u.value?"حدث خطأ أثناء جلب بيانات الحسابات":"Error fetching accounts data","error")}finally{M.value=!1}},Q=async()=>{S.value=!0;try{const n=await p.accountEntities.getEntities();s.value=n.data||[],C.value=[...s.value],$.value=1}catch(n){console.error("Error fetching entities:",n),d(u.value?"حدث خطأ أثناء جلب بيانات الكيانات":"Error fetching entities data","error")}finally{S.value=!1}},x=()=>{if(!L.value.trim())v.value=[...h.value];else{const n=L.value.toLowerCase();v.value=h.value.filter(r=>r.account.toLowerCase().includes(n)||r.parent.toLowerCase().includes(n)||r.alias_default&&r.alias_default.toLowerCase().includes(n))}D.value=1},tt=()=>{if(!T.value.trim())C.value=[...s.value];else{const n=T.value.toLowerCase();C.value=s.value.filter(r=>r.entity.toLowerCase().includes(n)||r.parent.toLowerCase().includes(n)||r.alias_default&&r.alias_default.toLowerCase().includes(n))}$.value=1},et=()=>{c.account="",c.parent="",c.alias_default=""},ut=n=>{m.value=!0,b.value=n,c.account=n.account,c.parent=n.parent,c.alias_default=n.alias_default,V.value=!0},st=n=>{b.value=n,U.value=u.value?`هل أنت متأكد من رغبتك في حذف الحساب: ${n.account}؟`:`Are you sure you want to delete account: ${n.account}?`,q.value="account",F.value=!0},nt=async()=>{try{m.value&&b.value?(await p.accountEntities.updateAccount(b.value.id,{account:c.account,parent:c.parent,alias_default:c.alias_default}),d(u.value?"تم تحديث الحساب بنجاح":"Account updated successfully")):(await p.accountEntities.createAccount({account:c.account,parent:c.parent,alias_default:c.alias_default}),d(u.value?"تم إنشاء الحساب بنجاح":"Account created successfully")),await N(),j()}catch(n){console.error("Error saving account:",n),d(u.value?"حدث خطأ أثناء حفظ الحساب":"Error saving account","error")}},at=async()=>{try{b.value&&(await p.accountEntities.deleteAccount(b.value.id),d(u.value?"تم حذف الحساب بنجاح":"Account deleted successfully"),await N())}catch(n){console.error("Error deleting account:",n),d(u.value?"حدث خطأ أثناء حذف الحساب":"Error deleting account","error")}},j=()=>{V.value=!1,m.value=!1,b.value=null,et()},ot=()=>{A.entity="",A.parent="",A.alias_default=""},it=n=>{m.value=!0,y.value=n,A.entity=n.entity,A.parent=n.parent,A.alias_default=n.alias_default,I.value=!0},lt=n=>{y.value=n,U.value=u.value?`هل أنت متأكد من رغبتك في حذف الكيان: ${n.entity}؟`:`Are you sure you want to delete entity: ${n.entity}?`,q.value="entity",F.value=!0},rt=async()=>{try{m.value&&y.value?(await p.accountEntities.updateEntity(y.value.id,{entity:A.entity,parent:A.parent,alias_default:A.alias_default}),d(u.value?"تم تحديث الكيان بنجاح":"Entity updated successfully")):(await p.accountEntities.createEntity({entity:A.entity,parent:A.parent,alias_default:A.alias_default}),d(u.value?"تم إنشاء الكيان بنجاح":"Entity created successfully")),await Q(),G()}catch(n){console.error("Error saving entity:",n),d(u.value?"حدث خطأ أثناء حفظ الكيان":"Error saving entity","error")}},dt=async()=>{try{y.value&&(await p.accountEntities.deleteEntity(y.value.id),d(u.value?"تم حذف الكيان بنجاح":"Entity deleted successfully"),await Q())}catch(n){console.error("Error deleting entity:",n),d(u.value?"حدث خطأ أثناء حذف الكيان":"Error deleting entity","error")}},G=()=>{I.value=!1,m.value=!1,y.value=null,ot()},ct=async()=>{q.value==="account"?await at():await dt(),F.value=!1},At=()=>{F.value=!1,b.value=null,y.value=null};return H(()=>{N(),Q()}),{activeTab:z,accounts:h,entities:s,filteredAccounts:v,filteredEntities:C,accountSearchQuery:L,entitySearchQuery:T,showAccountModal:V,showEntityModal:I,showConfirmDialog:F,isEditMode:m,confirmMessage:U,accountsLoading:M,entitiesLoading:S,currentAccountPage:D,currentEntityPage:$,totalAccountPages:X,totalEntityPages:Y,paginatedAccounts:Z,paginatedEntities:_,accountForm:c,entityForm:A,isArabic:u,isDarkMode:P,filterAccounts:x,filterEntities:tt,editAccount:ut,editEntity:it,confirmDeleteAccount:st,confirmDeleteEntity:lt,submitAccountForm:nt,submitEntityForm:rt,closeAccountModal:j,closeEntityModal:G,confirmDelete:ct,cancelDelete:At}}}),gt={class:"container"},Et={class:"tabs-container"},mt={class:"tabs"},ht={key:0,class:"accounts-tab"},Ct={class:"header-actions"},kt={class:"actions"},Ft={class:"search-box"},wt=["placeholder"],Pt={class:"data-table-container"},Dt={key:0,class:"loading-container"},$t={key:1},Mt={class:"table-info-bar"},St={class:"item-count"},Lt={key:0,class:"filtered-info"},Tt={class:"data-table"},Vt={class:"actions-column"},It={key:0},Ut={colspan:"5",class:"no-data"},qt={class:"actions"},Nt=["onClick"],Qt=["onClick"],Bt={key:0,class:"pagination"},zt=["disabled"],jt=["disabled"],Gt={class:"pagination-info"},Ht=["disabled"],Jt=["disabled"],Kt={key:1,class:"entities-tab"},Ot={class:"header-actions"},Rt={class:"actions"},Wt={class:"search-box"},Xt=["placeholder"],Yt={class:"data-table-container"},Zt={key:0,class:"loading-container"},_t={key:1},xt={class:"table-info-bar"},te={class:"item-count"},ee={key:0,class:"filtered-info"},ue={class:"data-table"},se={class:"actions-column"},ne={key:0},ae={colspan:"5",class:"no-data"},oe={class:"actions"},ie=["onClick"],le=["onClick"],re={key:0,class:"pagination"},de=["disabled"],ce=["disabled"],Ae={class:"pagination-info"},fe=["disabled"],ve=["disabled"],be={key:0,class:"modal"},ye={class:"modal-content"},pe={class:"modal-header"},ge={class:"modal-body"},Ee={class:"form-group"},me={for:"account-code"},he=["disabled","placeholder"],Ce={class:"form-group"},ke={for:"account-parent"},Fe=["placeholder"],we={class:"form-group"},Pe={for:"account-alias"},De=["placeholder"],$e={class:"form-actions"},Me={type:"submit",class:"btn-save"},Se={key:1,class:"modal"},Le={class:"modal-content"},Te={class:"modal-header"},Ve={class:"modal-body"},Ie={class:"form-group"},Ue={for:"entity-code"},qe=["disabled","placeholder"],Ne={class:"form-group"},Qe={for:"entity-parent"},Be=["placeholder"],ze={class:"form-group"},je={for:"entity-alias"},Ge=["placeholder"],He={class:"form-actions"},Je={type:"submit",class:"btn-save"},Ke={key:2,class:"modal confirmation-dialog"},Oe={class:"modal-content"},Re={class:"modal-header"},We={class:"modal-body"},Xe={class:"form-actions"};function Ye(t,u,P,d,z,h){return l(),i("main",{class:B(["accounts-entity-view",{"dark-mode":t.isDarkMode}])},[e("div",gt,[e("div",Et,[e("div",mt,[e("button",{class:B({active:t.activeTab==="accounts"}),onClick:u[0]||(u[0]=s=>t.activeTab="accounts")},a(t.isArabic?"الحسابات":"Accounts"),3),e("button",{class:B({active:t.activeTab==="entities"}),onClick:u[1]||(u[1]=s=>t.activeTab="entities")},a(t.isArabic?"الكيانات":"Entities"),3)])]),t.activeTab==="accounts"?(l(),i("div",ht,[e("div",Ct,[e("h2",null,a(t.isArabic?"إدارة الحسابات":"Accounts Management"),1),e("div",kt,[e("div",Ft,[g(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=s=>t.accountSearchQuery=s),placeholder:t.isArabic?"بحث في الحسابات...":"Search accounts...",onInput:u[3]||(u[3]=(...s)=>t.filterAccounts&&t.filterAccounts(...s))},null,40,wt),[[E,t.accountSearchQuery]]),u[30]||(u[30]=e("i",{class:"fas fa-search"},null,-1))]),e("button",{class:"btn-add",onClick:u[4]||(u[4]=s=>t.showAccountModal=!0)},[u[31]||(u[31]=e("i",{class:"fas fa-plus"},null,-1)),K(" "+a(t.isArabic?"إضافة حساب":"Add Account"),1)])])]),e("div",Pt,[t.accountsLoading?(l(),i("div",Dt,[u[32]||(u[32]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,a(t.isArabic?"جاري تحميل البيانات...":"Loading accounts..."),1)])):(l(),i("div",$t,[e("div",Mt,[e("span",St,a(t.isArabic?`إجمالي الحسابات: ${t.filteredAccounts.length}`:`Total Accounts: ${t.filteredAccounts.length}`),1),t.filteredAccounts.length!==t.accounts.length?(l(),i("span",Lt,a(t.isArabic?`(تصفية من ${t.accounts.length})`:`(Filtered from ${t.accounts.length})`),1)):f("",!0)]),e("table",Tt,[e("thead",null,[e("tr",null,[e("th",null,a(t.isArabic?"الحساب":"Account"),1),e("th",null,a(t.isArabic?"الأصل":"Parent"),1),e("th",null,a(t.isArabic?"الاسم المختصر":"Alias"),1),e("th",Vt,a(t.isArabic?"الإجراءات":"Actions"),1)])]),e("tbody",null,[t.filteredAccounts.length===0?(l(),i("tr",It,[e("td",Ut,a(t.isArabic?"لا توجد بيانات للعرض":"No accounts data to display"),1)])):f("",!0),(l(!0),i(O,null,R(t.paginatedAccounts,s=>(l(),i("tr",{key:s.id},[e("td",null,a(s.account),1),e("td",null,a(s.parent),1),e("td",null,a(s.alias_default),1),e("td",qt,[e("button",{onClick:v=>t.editAccount(s),class:"btn-edit"},u[33]||(u[33]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Nt),e("button",{onClick:v=>t.confirmDeleteAccount(s),class:"btn-delete"},u[34]||(u[34]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Qt)])]))),128))])]),t.filteredAccounts.length>0?(l(),i("div",Bt,[e("button",{class:"pagination-btn",disabled:t.currentAccountPage===1,onClick:u[5]||(u[5]=s=>t.currentAccountPage=1)},u[35]||(u[35]=[e("i",{class:"fas fa-angle-double-left"},null,-1)]),8,zt),e("button",{class:"pagination-btn",disabled:t.currentAccountPage===1,onClick:u[6]||(u[6]=s=>t.currentAccountPage--)},u[36]||(u[36]=[e("i",{class:"fas fa-angle-left"},null,-1)]),8,jt),e("div",Gt,a(t.isArabic?`صفحة ${t.currentAccountPage} من ${t.totalAccountPages}`:`Page ${t.currentAccountPage} of ${t.totalAccountPages}`),1),e("button",{class:"pagination-btn",disabled:t.currentAccountPage>=t.totalAccountPages,onClick:u[7]||(u[7]=s=>t.currentAccountPage++)},u[37]||(u[37]=[e("i",{class:"fas fa-angle-right"},null,-1)]),8,Ht),e("button",{class:"pagination-btn",disabled:t.currentAccountPage>=t.totalAccountPages,onClick:u[8]||(u[8]=s=>t.currentAccountPage=t.totalAccountPages)},u[38]||(u[38]=[e("i",{class:"fas fa-angle-double-right"},null,-1)]),8,Jt)])):f("",!0)]))])])):f("",!0),t.activeTab==="entities"?(l(),i("div",Kt,[e("div",Ot,[e("h2",null,a(t.isArabic?"إدارة الكيانات":"Entities Management"),1),e("div",Rt,[e("div",Wt,[g(e("input",{type:"text","onUpdate:modelValue":u[9]||(u[9]=s=>t.entitySearchQuery=s),placeholder:t.isArabic?"بحث في الكيانات...":"Search entities...",onInput:u[10]||(u[10]=(...s)=>t.filterEntities&&t.filterEntities(...s))},null,40,Xt),[[E,t.entitySearchQuery]]),u[39]||(u[39]=e("i",{class:"fas fa-search"},null,-1))]),e("button",{class:"btn-add",onClick:u[11]||(u[11]=s=>t.showEntityModal=!0)},[u[40]||(u[40]=e("i",{class:"fas fa-plus"},null,-1)),K(" "+a(t.isArabic?"إضافة كيان":"Add Entity"),1)])])]),e("div",Yt,[t.entitiesLoading?(l(),i("div",Zt,[u[41]||(u[41]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,a(t.isArabic?"جاري تحميل البيانات...":"Loading entities..."),1)])):(l(),i("div",_t,[e("div",xt,[e("span",te,a(t.isArabic?`إجمالي الكيانات: ${t.filteredEntities.length}`:`Total Entities: ${t.filteredEntities.length}`),1),t.filteredEntities.length!==t.entities.length?(l(),i("span",ee,a(t.isArabic?`(تصفية من ${t.entities.length})`:`(Filtered from ${t.entities.length})`),1)):f("",!0)]),e("table",ue,[e("thead",null,[e("tr",null,[e("th",null,a(t.isArabic?"الكيان":"Entity"),1),e("th",null,a(t.isArabic?"الأصل":"Parent"),1),e("th",null,a(t.isArabic?"الاسم المختصر":"Alias"),1),e("th",se,a(t.isArabic?"الإجراءات":"Actions"),1)])]),e("tbody",null,[t.filteredEntities.length===0?(l(),i("tr",ne,[e("td",ae,a(t.isArabic?"لا توجد بيانات للعرض":"No entities data to display"),1)])):f("",!0),(l(!0),i(O,null,R(t.paginatedEntities,s=>(l(),i("tr",{key:s.id},[e("td",null,a(s.entity),1),e("td",null,a(s.parent),1),e("td",null,a(s.alias_default),1),e("td",oe,[e("button",{onClick:v=>t.editEntity(s),class:"btn-edit"},u[42]||(u[42]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ie),e("button",{onClick:v=>t.confirmDeleteEntity(s),class:"btn-delete"},u[43]||(u[43]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,le)])]))),128))])]),t.filteredEntities.length>0?(l(),i("div",re,[e("button",{class:"pagination-btn",disabled:t.currentEntityPage===1,onClick:u[12]||(u[12]=s=>t.currentEntityPage=1)},u[44]||(u[44]=[e("i",{class:"fas fa-angle-double-left"},null,-1)]),8,de),e("button",{class:"pagination-btn",disabled:t.currentEntityPage===1,onClick:u[13]||(u[13]=s=>t.currentEntityPage--)},u[45]||(u[45]=[e("i",{class:"fas fa-angle-left"},null,-1)]),8,ce),e("div",Ae,a(t.isArabic?`صفحة ${t.currentEntityPage} من ${t.totalEntityPages}`:`Page ${t.currentEntityPage} of ${t.totalEntityPages}`),1),e("button",{class:"pagination-btn",disabled:t.currentEntityPage>=t.totalAccountPages,onClick:u[14]||(u[14]=s=>t.currentEntityPage++)},u[46]||(u[46]=[e("i",{class:"fas fa-angle-right"},null,-1)]),8,fe),e("button",{class:"pagination-btn",disabled:t.currentEntityPage>=t.totalAccountPages,onClick:u[15]||(u[15]=s=>t.currentEntityPage=t.totalAccountPages)},u[47]||(u[47]=[e("i",{class:"fas fa-angle-double-right"},null,-1)]),8,ve)])):f("",!0)]))])])):f("",!0)]),t.showAccountModal?(l(),i("div",be,[e("div",ye,[e("div",pe,[e("h3",null,a(t.isEditMode?t.isArabic?"تعديل الحساب":"Edit Account":t.isArabic?"إضافة حساب جديد":"Add New Account"),1),e("button",{onClick:u[16]||(u[16]=(...s)=>t.closeAccountModal&&t.closeAccountModal(...s)),class:"close-btn"},"×")]),e("div",ge,[e("form",{onSubmit:u[21]||(u[21]=W((...s)=>t.submitAccountForm&&t.submitAccountForm(...s),["prevent"]))},[e("div",Ee,[e("label",me,a(t.isArabic?"رمز الحساب":"Account Code"),1),g(e("input",{id:"account-code","onUpdate:modelValue":u[17]||(u[17]=s=>t.accountForm.account=s),type:"text",required:"",disabled:t.isEditMode,placeholder:t.isArabic?"أدخل رمز الحساب":"Enter account code"},null,8,he),[[E,t.accountForm.account]])]),e("div",Ce,[e("label",ke,a(t.isArabic?"الأصل":"Parent"),1),g(e("input",{id:"account-parent","onUpdate:modelValue":u[18]||(u[18]=s=>t.accountForm.parent=s),type:"text",required:"",placeholder:t.isArabic?"أدخل الأصل":"Enter parent"},null,8,Fe),[[E,t.accountForm.parent]])]),e("div",we,[e("label",Pe,a(t.isArabic?"الاسم المختصر":"Alias"),1),g(e("input",{id:"account-alias","onUpdate:modelValue":u[19]||(u[19]=s=>t.accountForm.alias_default=s),type:"text",placeholder:t.isArabic?"أدخل الاسم المختصر":"Enter alias"},null,8,De),[[E,t.accountForm.alias_default]])]),e("div",$e,[e("button",{type:"button",onClick:u[20]||(u[20]=(...s)=>t.closeAccountModal&&t.closeAccountModal(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),e("button",Me,a(t.isArabic?"حفظ":"Save"),1)])],32)])])])):f("",!0),t.showEntityModal?(l(),i("div",Se,[e("div",Le,[e("div",Te,[e("h3",null,a(t.isEditMode?t.isArabic?"تعديل الكيان":"Edit Entity":t.isArabic?"إضافة كيان جديد":"Add New Entity"),1),e("button",{onClick:u[22]||(u[22]=(...s)=>t.closeEntityModal&&t.closeEntityModal(...s)),class:"close-btn"},"×")]),e("div",Ve,[e("form",{onSubmit:u[27]||(u[27]=W((...s)=>t.submitEntityForm&&t.submitEntityForm(...s),["prevent"]))},[e("div",Ie,[e("label",Ue,a(t.isArabic?"رمز الكيان":"Entity Code"),1),g(e("input",{id:"entity-code","onUpdate:modelValue":u[23]||(u[23]=s=>t.entityForm.entity=s),type:"text",required:"",disabled:t.isEditMode,placeholder:t.isArabic?"أدخل رمز الكيان":"Enter entity code"},null,8,qe),[[E,t.entityForm.entity]])]),e("div",Ne,[e("label",Qe,a(t.isArabic?"الأصل":"Parent"),1),g(e("input",{id:"entity-parent","onUpdate:modelValue":u[24]||(u[24]=s=>t.entityForm.parent=s),type:"text",required:"",placeholder:t.isArabic?"أدخل الأصل":"Enter parent"},null,8,Be),[[E,t.entityForm.parent]])]),e("div",ze,[e("label",je,a(t.isArabic?"الاسم المختصر":"Alias"),1),g(e("input",{id:"entity-alias","onUpdate:modelValue":u[25]||(u[25]=s=>t.entityForm.alias_default=s),type:"text",placeholder:t.isArabic?"أدخل الاسم المختصر":"Enter alias"},null,8,Ge),[[E,t.entityForm.alias_default]])]),e("div",He,[e("button",{type:"button",onClick:u[26]||(u[26]=(...s)=>t.closeEntityModal&&t.closeEntityModal(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),e("button",Je,a(t.isArabic?"حفظ":"Save"),1)])],32)])])])):f("",!0),t.showConfirmDialog?(l(),i("div",Ke,[e("div",Oe,[e("div",Re,[e("h3",null,a(t.isArabic?"تأكيد الحذف":"Confirm Delete"),1)]),e("div",We,[e("p",null,a(t.confirmMessage),1),e("div",Xe,[e("button",{onClick:u[28]||(u[28]=(...s)=>t.cancelDelete&&t.cancelDelete(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),e("button",{onClick:u[29]||(u[29]=(...s)=>t.confirmDelete&&t.confirmDelete(...s)),class:"btn-delete"},a(t.isArabic?"حذف":"Delete"),1)])])])])):f("",!0)],2)}const xe=yt(pt,[["render",Ye],["__scopeId","data-v-82f20297"]]);export{xe as default};
