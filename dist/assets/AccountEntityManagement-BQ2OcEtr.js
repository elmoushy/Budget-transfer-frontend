import{d as U,u as F,y as C,r as v,o as z,e as u,f as e,h as p,t,b,E as w,F as E,B as A,n as S,p as j,s as r,_ as q}from"./index-Cre1HAju.js";import{a as M}from"./apiService-CkcypGzS.js";import"./api-D_YAzMdB.js";const G={class:"filter-section"},H={class:"filter-container"},J={for:"cost-center"},K={class:"select-container"},O={value:"",disabled:""},Q=["value"],R={key:0,class:"pagination-info"},W={key:0,class:"account-limits-container"},X={key:0,class:"loading-indicator"},Z={key:1,class:"limits-table"},ee=["onClick"],te={key:2,class:"pagination"},ae=["disabled"],se={class:"page-numbers"},oe=["onClick"],le=["disabled"],ne={key:1,class:"no-selection"},ie={key:2,class:"modal-overlay"},ue={class:"modal-content"},re={class:"limit-info"},ce={class:"info-row"},de={class:"info-value"},ve={class:"info-row"},_e={class:"info-label"},fe={class:"info-value"},he={class:"info-row"},me={class:"info-label"},pe={class:"info-value"},ge={class:"form-group"},be={for:"source-allowed"},we={value:"Yes"},ye={value:"No"},ke={class:"form-group"},Ce={for:"target-allowed"},Ee={value:"Yes"},Ae={value:"No"},Me={class:"form-group"},Pe={for:"transfer-allowed"},Ne={value:"Yes"},xe={value:"No"},Se={class:"modal-actions"},Le={type:"submit",class:"submit-btn"},Ve=U({__name:"AccountEntityManagement",setup($e){const P=F(),s=C(()=>P.language==="ar"),L=C(()=>P.darkMode),N=v([]),x=v([]),d=v(""),_=v(!1),g=v(!1),i=v({}),n=v(1),c=v(0),f=v(0);z(async()=>{await V()});async function V(){try{_.value=!0;const o=await M.accountEntities.getEntities();N.value=o.data}catch(o){console.error("Error fetching entities:",o)}finally{_.value=!1}}async function h(o=1){if(d.value)try{_.value=!0;const l=await M.accountEntities.getAccountLimits(d.value,o);x.value=l.results,f.value=l.count,c.value=Math.ceil(l.count/10),n.value=o}catch(l){console.error("Error fetching account limits:",l)}finally{_.value=!1}}function $(o){i.value={...o},g.value=!0}async function Y(){try{await M.accountEntities.updateAccountLimit(i.value.id,{is_transer_allowed_for_source:i.value.is_transer_allowed_for_source,is_transer_allowed_for_target:i.value.is_transer_allowed_for_target,is_transer_allowed:i.value.is_transer_allowed,account_id:i.value.account,entity_id:d.value,source_count:i.value.source_count,target_count:i.value.target_count}),g.value=!1,await h(n.value)}catch(o){console.error("Error updating account limit:",o)}}function T(){n.value<c.value&&h(n.value+1)}function D(){n.value>1&&h(n.value-1)}function I(o){const l=typeof o=="string"?parseInt(o,10):o;l!==n.value&&h(l)}const B=C(()=>{const o=[];if(c.value<=5)for(let a=1;a<=c.value;a++)o.push(a);else{o.push(1);let a=Math.max(2,n.value-1),m=Math.min(c.value-1,n.value+1);n.value<=2?m=Math.min(c.value-1,4):n.value>=c.value-1&&(a=Math.max(2,c.value-5+2)),a>2&&o.push("...");for(let k=a;k<=m;k++)o.push(k);m<c.value-1&&o.push("..."),o.push(c.value)}return o});function y(o){return s.value?o==="Yes"?"نعم":"لا":o}return(o,l)=>(r(),u("div",{class:S(["account-entity-management",{"dark-mode":L.value}])},[e("h1",null,t(s.value?"إدارة الحسابات والكيانات":"Account-Entity Management"),1),e("div",G,[e("div",H,[e("label",J,t(s.value?"مركز التكلفة:":"Cost Center:"),1),e("div",K,[b(e("select",{id:"cost-center","onUpdate:modelValue":l[0]||(l[0]=a=>d.value=a),onChange:l[1]||(l[1]=a=>h(1))},[e("option",O,t(s.value?"-- اختر مركز التكلفة --":"-- Select Cost Center --"),1),(r(!0),u(E,null,A(N.value,a=>(r(),u("option",{key:a.id,value:a.entity},t(a.alias_default),9,Q))),128))],544),[[w,d.value]])])]),d.value?(r(),u("div",R,t(s.value?`عرض ${(n.value-1)*10+1} - ${Math.min(n.value*10,f.value)} من ${f.value}`:`Showing ${(n.value-1)*10+1} - ${Math.min(n.value*10,f.value)} of ${f.value}`),1)):p("",!0)]),d.value?(r(),u("div",W,[_.value?(r(),u("div",X,t(s.value?"جاري التحميل...":"Loading..."),1)):(r(),u("table",Z,[e("thead",null,[e("tr",null,[l[6]||(l[6]=e("th",null,"ID",-1)),e("th",null,t(s.value?"رقم الحساب":"Account"),1),e("th",null,t(s.value?"مسموح للمصدر":"Source Allowed"),1),e("th",null,t(s.value?"مسموح للهدف":"Target Allowed"),1),e("th",null,t(s.value?"مسموح للنقل":"Transfer Allowed"),1),e("th",null,t(s.value?"الإجراءات":"Actions"),1)])]),e("tbody",null,[(r(!0),u(E,null,A(x.value,a=>(r(),u("tr",{key:a.id},[e("td",null,t(a.id),1),e("td",null,t(a.account),1),e("td",null,t(y(a.is_transer_allowed_for_source)),1),e("td",null,t(y(a.is_transer_allowed_for_target)),1),e("td",null,t(y(a.is_transer_allowed)),1),e("td",null,[e("button",{onClick:m=>$(a),class:"edit-btn"},t(s.value?"تعديل":"Edit"),9,ee)])]))),128))])])),c.value>1?(r(),u("div",te,[e("button",{onClick:D,disabled:n.value===1,class:"pagination-btn"},t(s.value?"السابق":"Previous"),9,ae),e("div",se,[(r(!0),u(E,null,A(B.value,a=>(r(),u("button",{key:a,onClick:m=>I(a),class:S(["page-number",{active:n.value===a}])},t(a),11,oe))),128))]),e("button",{onClick:T,disabled:n.value===c.value,class:"pagination-btn"},t(s.value?"التالي":"Next"),9,le)])):p("",!0)])):p("",!0),!d.value&&!_.value?(r(),u("div",ne,[e("p",null,t(s.value?"الرجاء اختيار مركز تكلفة لعرض حدود الحسابات.":"Please select a cost center to view account limits."),1)])):p("",!0),g.value?(r(),u("div",ie,[e("div",ue,[e("h2",null,t(s.value?"تعديل حدود الحساب":"Edit Account Limit"),1),e("form",{onSubmit:j(Y,["prevent"])},[e("div",re,[e("div",ce,[l[7]||(l[7]=e("span",{class:"info-label"},"ID:",-1)),e("span",de,t(i.value.id),1)]),e("div",ve,[e("span",_e,t(s.value?"رقم الحساب:":"Account:"),1),e("span",fe,t(i.value.account),1)]),e("div",he,[e("span",me,t(s.value?"الكيان:":"Entity:"),1),e("span",pe,t(d.value),1)])]),e("div",ge,[e("label",be,t(s.value?"مسموح للمصدر:":"Source Allowed:"),1),b(e("select",{id:"source-allowed","onUpdate:modelValue":l[2]||(l[2]=a=>i.value.is_transer_allowed_for_source=a)},[e("option",we,t(s.value?"نعم":"Yes"),1),e("option",ye,t(s.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed_for_source]])]),e("div",ke,[e("label",Ce,t(s.value?"مسموح للهدف:":"Target Allowed:"),1),b(e("select",{id:"target-allowed","onUpdate:modelValue":l[3]||(l[3]=a=>i.value.is_transer_allowed_for_target=a)},[e("option",Ee,t(s.value?"نعم":"Yes"),1),e("option",Ae,t(s.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed_for_target]])]),e("div",Me,[e("label",Pe,t(s.value?"مسموح للنقل:":"Transfer Allowed:"),1),b(e("select",{id:"transfer-allowed","onUpdate:modelValue":l[4]||(l[4]=a=>i.value.is_transer_allowed=a)},[e("option",Ne,t(s.value?"نعم":"Yes"),1),e("option",xe,t(s.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed]])]),e("div",Se,[e("button",{type:"button",onClick:l[5]||(l[5]=a=>g.value=!1),class:"cancel-btn"},t(s.value?"إلغاء":"Cancel"),1),e("button",Le,t(s.value?"حفظ":"Save"),1)])],32)])])):p("",!0)],2))}}),Ie=q(Ve,[["__scopeId","data-v-a2f6a4c9"]]);export{Ie as default};
