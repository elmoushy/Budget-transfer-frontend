import{a as y}from"./apiService-CkcypGzS.js";import{d as ft,u as vt,y as w,r as o,o as H,w as bt,a2 as J,_ as pt,e as i,s as l,f as u,h as f,n as Q,t as a,b as g,v as E,i as K,F as O,B as R,p as W}from"./index-Cre1HAju.js";import"./api-D_YAzMdB.js";const yt=ft({name:"Accounts_Entity_view",setup(){const t=vt(),e=w(()=>t.language==="ar"),D=o(!1);H(()=>{D.value=t.darkMode}),bt(()=>t.darkMode,n=>{D.value=n});const d=(n,r="success")=>{r==="error"?console.error(n):console.log(n),alert(n)},z=o("accounts"),h=o([]),s=o([]),v=o([]),C=o([]),M=o(!1),S=o(!1),k=8,P=o(1),$=o(1),X=w(()=>Math.ceil(v.value.length/k)),Y=w(()=>Math.ceil(C.value.length/k)),Z=w(()=>{const n=(P.value-1)*k,r=n+k;return v.value.slice(n,r)}),_=w(()=>{const n=($.value-1)*k,r=n+k;return C.value.slice(n,r)}),L=o(""),T=o(""),V=o(!1),I=o(!1),F=o(!1),m=o(!1),b=o(null),p=o(null),U=o(""),N=o(""),c=J({account:"",parent:"",alias_default:""}),A=J({entity:"",parent:"",alias_default:""}),q=async()=>{M.value=!0;try{const n=await y.accountEntities.getAccounts();h.value=n.data||[],v.value=[...h.value],P.value=1}catch(n){console.error("Error fetching accounts:",n),d(e.value?"حدث خطأ أثناء جلب بيانات الحسابات":"Error fetching accounts data","error")}finally{M.value=!1}},B=async()=>{S.value=!0;try{const n=await y.accountEntities.getEntities();s.value=n.data||[],C.value=[...s.value],$.value=1}catch(n){console.error("Error fetching entities:",n),d(e.value?"حدث خطأ أثناء جلب بيانات الكيانات":"Error fetching entities data","error")}finally{S.value=!1}},x=()=>{if(!L.value.trim())v.value=[...h.value];else{const n=L.value.toLowerCase();v.value=h.value.filter(r=>r.account.toLowerCase().includes(n)||r.parent.toLowerCase().includes(n)||r.alias_default&&r.alias_default.toLowerCase().includes(n))}P.value=1},tt=()=>{if(!T.value.trim())C.value=[...s.value];else{const n=T.value.toLowerCase();C.value=s.value.filter(r=>r.entity.toLowerCase().includes(n)||r.parent.toLowerCase().includes(n)||r.alias_default&&r.alias_default.toLowerCase().includes(n))}$.value=1},ut=()=>{c.account="",c.parent="",c.alias_default=""},et=n=>{m.value=!0,b.value=n,c.account=n.account,c.parent=n.parent,c.alias_default=n.alias_default,V.value=!0},st=n=>{b.value=n,U.value=e.value?`هل أنت متأكد من رغبتك في حذف الحساب: ${n.account}؟`:`Are you sure you want to delete account: ${n.account}?`,N.value="account",F.value=!0},nt=async()=>{try{m.value&&b.value?(await y.accountEntities.updateAccount(b.value.id,{parent:c.parent,alias_default:c.alias_default}),d(e.value?"تم تحديث الحساب بنجاح":"Account updated successfully")):(await y.accountEntities.createAccount({account:c.account,parent:c.parent,alias_default:c.alias_default}),d(e.value?"تم إنشاء الحساب بنجاح":"Account created successfully")),await q(),j()}catch(n){console.error("Error saving account:",n),d(e.value?"حدث خطأ أثناء حفظ الحساب":"Error saving account","error")}},at=async()=>{try{b.value&&(await y.accountEntities.deleteAccount(b.value.id),d(e.value?"تم حذف الحساب بنجاح":"Account deleted successfully"),await q())}catch(n){console.error("Error deleting account:",n),d(e.value?"حدث خطأ أثناء حذف الحساب":"Error deleting account","error")}},j=()=>{V.value=!1,m.value=!1,b.value=null,ut()},ot=()=>{A.entity="",A.parent="",A.alias_default=""},it=n=>{m.value=!0,p.value=n,A.entity=n.entity,A.parent=n.parent,A.alias_default=n.alias_default,I.value=!0},lt=n=>{p.value=n,U.value=e.value?`هل أنت متأكد من رغبتك في حذف الكيان: ${n.entity}؟`:`Are you sure you want to delete entity: ${n.entity}?`,N.value="entity",F.value=!0},rt=async()=>{try{m.value&&p.value?(await y.accountEntities.updateEntity(p.value.id,{parent:A.parent,alias_default:A.alias_default}),d(e.value?"تم تحديث الكيان بنجاح":"Entity updated successfully")):(await y.accountEntities.createEntity({entity:A.entity,parent:A.parent,alias_default:A.alias_default}),d(e.value?"تم إنشاء الكيان بنجاح":"Entity created successfully")),await B(),G()}catch(n){console.error("Error saving entity:",n),d(e.value?"حدث خطأ أثناء حفظ الكيان":"Error saving entity","error")}},dt=async()=>{try{p.value&&(await y.accountEntities.deleteEntity(p.value.id),d(e.value?"تم حذف الكيان بنجاح":"Entity deleted successfully"),await B())}catch(n){console.error("Error deleting entity:",n),d(e.value?"حدث خطأ أثناء حذف الكيان":"Error deleting entity","error")}},G=()=>{I.value=!1,m.value=!1,p.value=null,ot()},ct=async()=>{N.value==="account"?await at():await dt(),F.value=!1},At=()=>{F.value=!1,b.value=null,p.value=null};return H(()=>{q(),B()}),{activeTab:z,accounts:h,entities:s,filteredAccounts:v,filteredEntities:C,accountSearchQuery:L,entitySearchQuery:T,showAccountModal:V,showEntityModal:I,showConfirmDialog:F,isEditMode:m,confirmMessage:U,accountsLoading:M,entitiesLoading:S,currentAccountPage:P,currentEntityPage:$,totalAccountPages:X,totalEntityPages:Y,paginatedAccounts:Z,paginatedEntities:_,accountForm:c,entityForm:A,isArabic:e,isDarkMode:D,filterAccounts:x,filterEntities:tt,editAccount:et,editEntity:it,confirmDeleteAccount:st,confirmDeleteEntity:lt,submitAccountForm:nt,submitEntityForm:rt,closeAccountModal:j,closeEntityModal:G,confirmDelete:ct,cancelDelete:At}}}),gt={class:"container"},Et={class:"tabs-container"},mt={class:"tabs"},ht={key:0,class:"accounts-tab"},Ct={class:"header-actions"},kt={class:"actions"},Ft={class:"search-box"},wt=["placeholder"],Dt={class:"data-table-container"},Pt={key:0,class:"loading-container"},$t={key:1},Mt={class:"table-info-bar"},St={class:"item-count"},Lt={key:0,class:"filtered-info"},Tt={class:"data-table"},Vt={class:"actions-column"},It={key:0},Ut={colspan:"5",class:"no-data"},Nt={class:"actions"},qt=["onClick"],Bt=["onClick"],Qt={key:0,class:"pagination"},zt=["disabled"],jt=["disabled"],Gt={class:"pagination-info"},Ht=["disabled"],Jt=["disabled"],Kt={key:1,class:"entities-tab"},Ot={class:"header-actions"},Rt={class:"actions"},Wt={class:"search-box"},Xt=["placeholder"],Yt={class:"data-table-container"},Zt={key:0,class:"loading-container"},_t={key:1},xt={class:"table-info-bar"},tu={class:"item-count"},uu={key:0,class:"filtered-info"},eu={class:"data-table"},su={class:"actions-column"},nu={key:0},au={colspan:"5",class:"no-data"},ou={class:"actions"},iu=["onClick"],lu=["onClick"],ru={key:0,class:"pagination"},du=["disabled"],cu=["disabled"],Au={class:"pagination-info"},fu=["disabled"],vu=["disabled"],bu={key:0,class:"modal"},pu={class:"modal-content"},yu={class:"modal-header"},gu={class:"modal-body"},Eu={class:"form-group"},mu={for:"account-code"},hu=["disabled","placeholder"],Cu={class:"form-group"},ku={for:"account-parent"},Fu=["placeholder"],wu={class:"form-group"},Du={for:"account-alias"},Pu=["placeholder"],$u={class:"form-actions"},Mu={type:"submit",class:"btn-save"},Su={key:1,class:"modal"},Lu={class:"modal-content"},Tu={class:"modal-header"},Vu={class:"modal-body"},Iu={class:"form-group"},Uu={for:"entity-code"},Nu=["disabled","placeholder"],qu={class:"form-group"},Bu={for:"entity-parent"},Qu=["placeholder"],zu={class:"form-group"},ju={for:"entity-alias"},Gu=["placeholder"],Hu={class:"form-actions"},Ju={type:"submit",class:"btn-save"},Ku={key:2,class:"modal confirmation-dialog"},Ou={class:"modal-content"},Ru={class:"modal-header"},Wu={class:"modal-body"},Xu={class:"form-actions"};function Yu(t,e,D,d,z,h){return l(),i("main",{class:Q(["accounts-entity-view",{"dark-mode":t.isDarkMode}])},[u("div",gt,[u("div",Et,[u("div",mt,[u("button",{class:Q({active:t.activeTab==="accounts"}),onClick:e[0]||(e[0]=s=>t.activeTab="accounts")},a(t.isArabic?"الحسابات":"Accounts"),3),u("button",{class:Q({active:t.activeTab==="entities"}),onClick:e[1]||(e[1]=s=>t.activeTab="entities")},a(t.isArabic?"الكيانات":"Entities"),3)])]),t.activeTab==="accounts"?(l(),i("div",ht,[u("div",Ct,[u("h2",null,a(t.isArabic?"إدارة الحسابات":"Accounts Management"),1),u("div",kt,[u("div",Ft,[g(u("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>t.accountSearchQuery=s),placeholder:t.isArabic?"بحث في الحسابات...":"Search accounts...",onInput:e[3]||(e[3]=(...s)=>t.filterAccounts&&t.filterAccounts(...s))},null,40,wt),[[E,t.accountSearchQuery]]),e[30]||(e[30]=u("i",{class:"fas fa-search"},null,-1))]),u("button",{class:"btn-add",onClick:e[4]||(e[4]=s=>t.showAccountModal=!0)},[e[31]||(e[31]=u("i",{class:"fas fa-plus"},null,-1)),K(" "+a(t.isArabic?"إضافة حساب":"Add Account"),1)])])]),u("div",Dt,[t.accountsLoading?(l(),i("div",Pt,[e[32]||(e[32]=u("div",{class:"loading-spinner"},null,-1)),u("p",null,a(t.isArabic?"جاري تحميل البيانات...":"Loading accounts..."),1)])):(l(),i("div",$t,[u("div",Mt,[u("span",St,a(t.isArabic?`إجمالي الحسابات: ${t.filteredAccounts.length}`:`Total Accounts: ${t.filteredAccounts.length}`),1),t.filteredAccounts.length!==t.accounts.length?(l(),i("span",Lt,a(t.isArabic?`(تصفية من ${t.accounts.length})`:`(Filtered from ${t.accounts.length})`),1)):f("",!0)]),u("table",Tt,[u("thead",null,[u("tr",null,[u("th",null,a(t.isArabic?"الرقم التعريفي":"ID"),1),u("th",null,a(t.isArabic?"الحساب":"Account"),1),u("th",null,a(t.isArabic?"الأصل":"Parent"),1),u("th",null,a(t.isArabic?"الاسم المختصر":"Alias"),1),u("th",Vt,a(t.isArabic?"الإجراءات":"Actions"),1)])]),u("tbody",null,[t.filteredAccounts.length===0?(l(),i("tr",It,[u("td",Ut,a(t.isArabic?"لا توجد بيانات للعرض":"No accounts data to display"),1)])):f("",!0),(l(!0),i(O,null,R(t.paginatedAccounts,s=>(l(),i("tr",{key:s.id},[u("td",null,a(s.id),1),u("td",null,a(s.account),1),u("td",null,a(s.parent),1),u("td",null,a(s.alias_default),1),u("td",Nt,[u("button",{onClick:v=>t.editAccount(s),class:"btn-edit"},e[33]||(e[33]=[u("i",{class:"fas fa-edit"},null,-1)]),8,qt),u("button",{onClick:v=>t.confirmDeleteAccount(s),class:"btn-delete"},e[34]||(e[34]=[u("i",{class:"fas fa-trash-alt"},null,-1)]),8,Bt)])]))),128))])]),t.filteredAccounts.length>0?(l(),i("div",Qt,[u("button",{class:"pagination-btn",disabled:t.currentAccountPage===1,onClick:e[5]||(e[5]=s=>t.currentAccountPage=1)},e[35]||(e[35]=[u("i",{class:"fas fa-angle-double-left"},null,-1)]),8,zt),u("button",{class:"pagination-btn",disabled:t.currentAccountPage===1,onClick:e[6]||(e[6]=s=>t.currentAccountPage--)},e[36]||(e[36]=[u("i",{class:"fas fa-angle-left"},null,-1)]),8,jt),u("div",Gt,a(t.isArabic?`صفحة ${t.currentAccountPage} من ${t.totalAccountPages}`:`Page ${t.currentAccountPage} of ${t.totalAccountPages}`),1),u("button",{class:"pagination-btn",disabled:t.currentAccountPage>=t.totalAccountPages,onClick:e[7]||(e[7]=s=>t.currentAccountPage++)},e[37]||(e[37]=[u("i",{class:"fas fa-angle-right"},null,-1)]),8,Ht),u("button",{class:"pagination-btn",disabled:t.currentAccountPage>=t.totalAccountPages,onClick:e[8]||(e[8]=s=>t.currentAccountPage=t.totalAccountPages)},e[38]||(e[38]=[u("i",{class:"fas fa-angle-double-right"},null,-1)]),8,Jt)])):f("",!0)]))])])):f("",!0),t.activeTab==="entities"?(l(),i("div",Kt,[u("div",Ot,[u("h2",null,a(t.isArabic?"إدارة الكيانات":"Entities Management"),1),u("div",Rt,[u("div",Wt,[g(u("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=s=>t.entitySearchQuery=s),placeholder:t.isArabic?"بحث في الكيانات...":"Search entities...",onInput:e[10]||(e[10]=(...s)=>t.filterEntities&&t.filterEntities(...s))},null,40,Xt),[[E,t.entitySearchQuery]]),e[39]||(e[39]=u("i",{class:"fas fa-search"},null,-1))]),u("button",{class:"btn-add",onClick:e[11]||(e[11]=s=>t.showEntityModal=!0)},[e[40]||(e[40]=u("i",{class:"fas fa-plus"},null,-1)),K(" "+a(t.isArabic?"إضافة كيان":"Add Entity"),1)])])]),u("div",Yt,[t.entitiesLoading?(l(),i("div",Zt,[e[41]||(e[41]=u("div",{class:"loading-spinner"},null,-1)),u("p",null,a(t.isArabic?"جاري تحميل البيانات...":"Loading entities..."),1)])):(l(),i("div",_t,[u("div",xt,[u("span",tu,a(t.isArabic?`إجمالي الكيانات: ${t.filteredEntities.length}`:`Total Entities: ${t.filteredEntities.length}`),1),t.filteredEntities.length!==t.entities.length?(l(),i("span",uu,a(t.isArabic?`(تصفية من ${t.entities.length})`:`(Filtered from ${t.entities.length})`),1)):f("",!0)]),u("table",eu,[u("thead",null,[u("tr",null,[u("th",null,a(t.isArabic?"الرقم التعريفي":"ID"),1),u("th",null,a(t.isArabic?"الكيان":"Entity"),1),u("th",null,a(t.isArabic?"الأصل":"Parent"),1),u("th",null,a(t.isArabic?"الاسم المختصر":"Alias"),1),u("th",su,a(t.isArabic?"الإجراءات":"Actions"),1)])]),u("tbody",null,[t.filteredEntities.length===0?(l(),i("tr",nu,[u("td",au,a(t.isArabic?"لا توجد بيانات للعرض":"No entities data to display"),1)])):f("",!0),(l(!0),i(O,null,R(t.paginatedEntities,s=>(l(),i("tr",{key:s.id},[u("td",null,a(s.id),1),u("td",null,a(s.entity),1),u("td",null,a(s.parent),1),u("td",null,a(s.alias_default),1),u("td",ou,[u("button",{onClick:v=>t.editEntity(s),class:"btn-edit"},e[42]||(e[42]=[u("i",{class:"fas fa-edit"},null,-1)]),8,iu),u("button",{onClick:v=>t.confirmDeleteEntity(s),class:"btn-delete"},e[43]||(e[43]=[u("i",{class:"fas fa-trash-alt"},null,-1)]),8,lu)])]))),128))])]),t.filteredEntities.length>0?(l(),i("div",ru,[u("button",{class:"pagination-btn",disabled:t.currentEntityPage===1,onClick:e[12]||(e[12]=s=>t.currentEntityPage=1)},e[44]||(e[44]=[u("i",{class:"fas fa-angle-double-left"},null,-1)]),8,du),u("button",{class:"pagination-btn",disabled:t.currentEntityPage===1,onClick:e[13]||(e[13]=s=>t.currentEntityPage--)},e[45]||(e[45]=[u("i",{class:"fas fa-angle-left"},null,-1)]),8,cu),u("div",Au,a(t.isArabic?`صفحة ${t.currentEntityPage} من ${t.totalEntityPages}`:`Page ${t.currentEntityPage} of ${t.totalEntityPages}`),1),u("button",{class:"pagination-btn",disabled:t.currentEntityPage>=t.totalAccountPages,onClick:e[14]||(e[14]=s=>t.currentEntityPage++)},e[46]||(e[46]=[u("i",{class:"fas fa-angle-right"},null,-1)]),8,fu),u("button",{class:"pagination-btn",disabled:t.currentEntityPage>=t.totalAccountPages,onClick:e[15]||(e[15]=s=>t.currentEntityPage=t.totalAccountPages)},e[47]||(e[47]=[u("i",{class:"fas fa-angle-double-right"},null,-1)]),8,vu)])):f("",!0)]))])])):f("",!0)]),t.showAccountModal?(l(),i("div",bu,[u("div",pu,[u("div",yu,[u("h3",null,a(t.isEditMode?t.isArabic?"تعديل الحساب":"Edit Account":t.isArabic?"إضافة حساب جديد":"Add New Account"),1),u("button",{onClick:e[16]||(e[16]=(...s)=>t.closeAccountModal&&t.closeAccountModal(...s)),class:"close-btn"},"×")]),u("div",gu,[u("form",{onSubmit:e[21]||(e[21]=W((...s)=>t.submitAccountForm&&t.submitAccountForm(...s),["prevent"]))},[u("div",Eu,[u("label",mu,a(t.isArabic?"رمز الحساب":"Account Code"),1),g(u("input",{id:"account-code","onUpdate:modelValue":e[17]||(e[17]=s=>t.accountForm.account=s),type:"text",required:"",disabled:t.isEditMode,placeholder:t.isArabic?"أدخل رمز الحساب":"Enter account code"},null,8,hu),[[E,t.accountForm.account]])]),u("div",Cu,[u("label",ku,a(t.isArabic?"الأصل":"Parent"),1),g(u("input",{id:"account-parent","onUpdate:modelValue":e[18]||(e[18]=s=>t.accountForm.parent=s),type:"text",required:"",placeholder:t.isArabic?"أدخل الأصل":"Enter parent"},null,8,Fu),[[E,t.accountForm.parent]])]),u("div",wu,[u("label",Du,a(t.isArabic?"الاسم المختصر":"Alias"),1),g(u("input",{id:"account-alias","onUpdate:modelValue":e[19]||(e[19]=s=>t.accountForm.alias_default=s),type:"text",placeholder:t.isArabic?"أدخل الاسم المختصر":"Enter alias"},null,8,Pu),[[E,t.accountForm.alias_default]])]),u("div",$u,[u("button",{type:"button",onClick:e[20]||(e[20]=(...s)=>t.closeAccountModal&&t.closeAccountModal(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),u("button",Mu,a(t.isArabic?"حفظ":"Save"),1)])],32)])])])):f("",!0),t.showEntityModal?(l(),i("div",Su,[u("div",Lu,[u("div",Tu,[u("h3",null,a(t.isEditMode?t.isArabic?"تعديل الكيان":"Edit Entity":t.isArabic?"إضافة كيان جديد":"Add New Entity"),1),u("button",{onClick:e[22]||(e[22]=(...s)=>t.closeEntityModal&&t.closeEntityModal(...s)),class:"close-btn"},"×")]),u("div",Vu,[u("form",{onSubmit:e[27]||(e[27]=W((...s)=>t.submitEntityForm&&t.submitEntityForm(...s),["prevent"]))},[u("div",Iu,[u("label",Uu,a(t.isArabic?"رمز الكيان":"Entity Code"),1),g(u("input",{id:"entity-code","onUpdate:modelValue":e[23]||(e[23]=s=>t.entityForm.entity=s),type:"text",required:"",disabled:t.isEditMode,placeholder:t.isArabic?"أدخل رمز الكيان":"Enter entity code"},null,8,Nu),[[E,t.entityForm.entity]])]),u("div",qu,[u("label",Bu,a(t.isArabic?"الأصل":"Parent"),1),g(u("input",{id:"entity-parent","onUpdate:modelValue":e[24]||(e[24]=s=>t.entityForm.parent=s),type:"text",required:"",placeholder:t.isArabic?"أدخل الأصل":"Enter parent"},null,8,Qu),[[E,t.entityForm.parent]])]),u("div",zu,[u("label",ju,a(t.isArabic?"الاسم المختصر":"Alias"),1),g(u("input",{id:"entity-alias","onUpdate:modelValue":e[25]||(e[25]=s=>t.entityForm.alias_default=s),type:"text",placeholder:t.isArabic?"أدخل الاسم المختصر":"Enter alias"},null,8,Gu),[[E,t.entityForm.alias_default]])]),u("div",Hu,[u("button",{type:"button",onClick:e[26]||(e[26]=(...s)=>t.closeEntityModal&&t.closeEntityModal(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),u("button",Ju,a(t.isArabic?"حفظ":"Save"),1)])],32)])])])):f("",!0),t.showConfirmDialog?(l(),i("div",Ku,[u("div",Ou,[u("div",Ru,[u("h3",null,a(t.isArabic?"تأكيد الحذف":"Confirm Delete"),1)]),u("div",Wu,[u("p",null,a(t.confirmMessage),1),u("div",Xu,[u("button",{onClick:e[28]||(e[28]=(...s)=>t.cancelDelete&&t.cancelDelete(...s)),class:"btn-cancel"},a(t.isArabic?"إلغاء":"Cancel"),1),u("button",{onClick:e[29]||(e[29]=(...s)=>t.confirmDelete&&t.confirmDelete(...s)),class:"btn-delete"},a(t.isArabic?"حذف":"Delete"),1)])])])])):f("",!0)],2)}const te=pt(yt,[["render",Yu],["__scopeId","data-v-6f34161e"]]);export{te as default};
