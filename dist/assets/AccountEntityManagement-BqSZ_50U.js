import{d as O,u as j,B as w,r as _,o as J,s as A,e as i,f as e,h,t,I as K,b as k,v as Q,F as T,G as V,n as $,m as W,H as P,q as r,y as X}from"./index-DwiZp2IY.js";import{S as Z}from"./SearchableDropdown-CTS9cKNM.js";const ee={class:"filter-section"},te={class:"filter-container"},ae={for:"cost-center"},le={class:"select-container"},oe={key:0,class:"pagination-info"},se={key:0,class:"search-status"},ne={key:0,class:"search-section"},ue={class:"search-container"},ie={for:"account-search"},re={class:"search-input-container"},ce=["placeholder"],de={key:1,class:"account-limits-container"},ve={key:0,class:"loading-indicator"},_e={key:1,class:"limits-table"},he=["onClick"],fe={key:2,class:"pagination"},me=["disabled"],pe={class:"page-numbers"},ge=["onClick"],be=["disabled"],we={key:2,class:"no-selection"},ye={key:3,class:"modal-overlay"},ke={class:"modal-content"},Ce={class:"limit-info"},Me={class:"info-row"},Se={class:"info-label"},Ae={class:"info-value"},Pe={class:"info-row"},Ee={class:"info-label"},Ne={class:"info-value"},xe={class:"form-group"},Te={for:"source-allowed"},Ve={value:"Yes"},$e={value:"No"},Le={class:"form-group"},Ye={for:"target-allowed"},De={value:"Yes"},Ie={value:"No"},Ue={class:"form-group"},Be={for:"transfer-allowed"},Re={value:"Yes"},Fe={value:"No"},qe={class:"modal-actions"},ze={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},Ge=10,He=O({__name:"AccountEntityManagement",setup(Oe){const E=j(),a=w(()=>E.language==="ar"),N=w(()=>E.darkMode),L=w(()=>x.value.map(l=>({value:l.entity,label:l.alias_default}))),x=_([]),C=_([]),d=_(""),p=_(!1),y=_(!1),u=_({id:0,account:"",is_transer_allowed_for_source:"No",is_transer_allowed_for_target:"No",is_transer_allowed:"No",source_count:0,target_count:0}),v=_(""),s=_(1),c=_(0),f=_(0);J(async()=>{await D()});function Y(){v.value="",s.value=1,m()}async function D(){try{p.value=!0;const l=await A.accountEntities.getEntities();x.value=l.data}catch(l){console.error("Error fetching entities:",l)}finally{p.value=!1}}async function m(){if(d.value)try{p.value=!0;const l=await A.accountEntities.getAccountLimits(d.value,s.value,v.value.trim());C.value=l.results||[],f.value=l.count||0,c.value=Math.ceil(f.value/Ge)}catch(l){console.error("Error fetching account limits:",l),C.value=[],f.value=0,c.value=0}finally{p.value=!1}}function I(l){u.value={...l},y.value=!0}async function U(){try{await A.accountEntities.updateAccountLimit(u.value.id,{is_transer_allowed_for_source:u.value.is_transer_allowed_for_source,is_transer_allowed_for_target:u.value.is_transer_allowed_for_target,is_transer_allowed:u.value.is_transer_allowed,account_id:u.value.account,entity_id:d.value,source_count:u.value.source_count,target_count:u.value.target_count}),y.value=!1,await m()}catch(l){console.error("Error updating account limit:",l)}}function B(){s.value<c.value&&(s.value++,m())}function R(){s.value>1&&(s.value--,m())}function F(l){const n=typeof l=="string"?parseInt(l,10):l;n!==s.value&&n>=1&&n<=c.value&&(s.value=n,m())}const q=w(()=>{const l=[];if(c.value<=5)for(let o=1;o<=c.value;o++)l.push(o);else{l.push(1);let o=Math.max(2,s.value-1),b=Math.min(c.value-1,s.value+1);s.value<=2?b=Math.min(c.value-1,4):s.value>=c.value-1&&(o=Math.max(2,c.value-5+2)),o>2&&l.push("...");for(let S=o;S<=b;S++)l.push(S);b<c.value-1&&l.push("..."),l.push(c.value)}return l}),z=w(()=>v.value.trim()?a.value?`البحث عن: "${v.value}"`:`Searching for: "${v.value}"`:"");function M(l){return a.value?l==="Yes"?"نعم":"لا":l}let g=null;function G(){g&&clearTimeout(g),g=setTimeout(()=>{s.value=1,m()},300)}function H(){g&&(clearTimeout(g),g=null),v.value="",s.value=1,m()}return(l,n)=>(r(),i("div",{class:$(["account-entity-management",{"dark-mode":N.value}])},[e("h1",null,t(a.value?"إدارة الحسابات والكيانات":"Account-Entity Management"),1),e("div",ee,[e("div",te,[e("label",ae,t(a.value?"مركز التكلفة:":"Cost Center:"),1),e("div",le,[K(Z,{modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o),options:L.value,placeholder:a.value?"-- اختر مركز التكلفة --":"-- Select Cost Center --",searchPlaceholder:a.value?"البحث في مراكز التكلفة...":"Search cost centers...",noResultsText:a.value?"لا توجد نتائج":"No results found",isDarkMode:N.value,isRtl:a.value,onChange:Y},null,8,["modelValue","options","placeholder","searchPlaceholder","noResultsText","isDarkMode","isRtl"])])]),d.value?(r(),i("div",oe,[e("div",null,t(a.value?`عرض ${(s.value-1)*10+1} - ${Math.min(s.value*10,f.value)} من ${f.value}`:`Showing ${(s.value-1)*10+1} - ${Math.min(s.value*10,f.value)} of ${f.value}`),1),v.value.trim()?(r(),i("div",se,t(z.value),1)):h("",!0)])):h("",!0)]),d.value?(r(),i("div",ne,[e("div",ue,[e("label",ie,t(a.value?"البحث في الحسابات:":"Search Accounts:"),1),e("div",re,[k(e("input",{id:"account-search","onUpdate:modelValue":n[1]||(n[1]=o=>v.value=o),type:"text",placeholder:a.value?"ادخل رقم الحساب للبحث...":"Enter account number to search...",onInput:G},null,40,ce),[[Q,v.value]]),v.value?(r(),i("button",{key:0,onClick:H,class:"clear-search-btn"},"✕")):h("",!0)])])])):h("",!0),d.value?(r(),i("div",de,[p.value?(r(),i("div",ve,t(a.value?"جاري التحميل...":"Loading..."),1)):(r(),i("table",_e,[e("thead",null,[e("tr",null,[n[6]||(n[6]=e("th",null,"ID",-1)),e("th",null,t(a.value?"رقم الحساب":"Account"),1),e("th",null,t(a.value?"مسموح للمصدر":"Source Allowed"),1),e("th",null,t(a.value?"مسموح للهدف":"Target Allowed"),1),e("th",null,t(a.value?"مسموح للنقل":"Transfer Allowed"),1),e("th",null,t(a.value?"الإجراءات":"Actions"),1)])]),e("tbody",null,[(r(!0),i(T,null,V(C.value,o=>(r(),i("tr",{key:o.id},[e("td",null,t(o.id),1),e("td",null,t(o.account),1),e("td",null,t(M(o.is_transer_allowed_for_source)),1),e("td",null,t(M(o.is_transer_allowed_for_target)),1),e("td",null,t(M(o.is_transer_allowed)),1),e("td",null,[e("button",{onClick:b=>I(o),class:"edit-btn"},t(a.value?"تعديل":"Edit"),9,he)])]))),128))])])),c.value>1?(r(),i("div",fe,[e("button",{onClick:R,disabled:s.value===1,class:"pagination-btn"},t(a.value?"السابق":"Previous"),9,me),e("div",pe,[(r(!0),i(T,null,V(q.value,o=>(r(),i("button",{key:o,onClick:b=>F(o),class:$(["page-number",{active:s.value===o}])},t(o),11,ge))),128))]),e("button",{onClick:B,disabled:s.value===c.value,class:"pagination-btn"},t(a.value?"التالي":"Next"),9,be)])):h("",!0)])):h("",!0),!d.value&&!p.value?(r(),i("div",we,[e("p",null,t(a.value?"الرجاء اختيار مركز تكلفة لعرض حدود الحسابات.":"Please select a cost center to view account limits."),1)])):h("",!0),y.value?(r(),i("div",ye,[e("div",ke,[e("h2",null,t(a.value?"تعديل حدود الحساب":"Edit Account Limit"),1),e("form",{onSubmit:W(U,["prevent"])},[e("div",Ce,[e("div",Me,[e("span",Se,t(a.value?"رقم الحساب:":"Account:"),1),e("span",Ae,t(u.value.account),1)]),e("div",Pe,[e("span",Ee,t(a.value?"الكيان:":"Entity:"),1),e("span",Ne,t(d.value),1)])]),e("div",xe,[e("label",Te,t(a.value?"مسموح للمصدر:":"Source Allowed:"),1),k(e("select",{id:"source-allowed","onUpdate:modelValue":n[2]||(n[2]=o=>u.value.is_transer_allowed_for_source=o)},[e("option",Ve,t(a.value?"نعم":"Yes"),1),e("option",$e,t(a.value?"لا":"No"),1)],512),[[P,u.value.is_transer_allowed_for_source]])]),e("div",Le,[e("label",Ye,t(a.value?"مسموح للهدف:":"Target Allowed:"),1),k(e("select",{id:"target-allowed","onUpdate:modelValue":n[3]||(n[3]=o=>u.value.is_transer_allowed_for_target=o)},[e("option",De,t(a.value?"نعم":"Yes"),1),e("option",Ie,t(a.value?"لا":"No"),1)],512),[[P,u.value.is_transer_allowed_for_target]])]),e("div",Ue,[e("label",Be,t(a.value?"مسموح للنقل:":"Transfer Allowed:"),1),k(e("select",{id:"transfer-allowed","onUpdate:modelValue":n[4]||(n[4]=o=>u.value.is_transer_allowed=o)},[e("option",Re,t(a.value?"نعم":"Yes"),1),e("option",Fe,t(a.value?"لا":"No"),1)],512),[[P,u.value.is_transer_allowed]])]),e("div",qe,[e("button",{type:"button",onClick:n[5]||(n[5]=o=>y.value=!1),class:"cancel-btn"},t(a.value?"إلغاء":"Cancel"),1),e("button",ze,t(a.value?"حفظ":"Save"),1)])],32)])])):h("",!0)],2))}}),Ke=X(He,[["__scopeId","data-v-dec979d7"]]);export{Ke as default};
