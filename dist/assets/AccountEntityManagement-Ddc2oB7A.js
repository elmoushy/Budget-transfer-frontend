import{d as B,u as F,y as C,r as v,o as q,e as u,f as e,h as p,t,b,H as w,F as A,C as E,n as S,m as z,q as r,s as H}from"./index-DKsQNwYd.js";import{a as M}from"./apiService-Bs_XDTQg.js";const j={class:"filter-section"},G={class:"filter-container"},J={for:"cost-center"},K={class:"select-container"},O={value:"",disabled:""},Q=["value"],R={key:0,class:"pagination-info"},W={key:0,class:"account-limits-container"},X={key:0,class:"loading-indicator"},Z={key:1,class:"limits-table"},ee=["onClick"],te={key:2,class:"pagination"},ae=["disabled"],oe={class:"page-numbers"},le=["onClick"],se=["disabled"],ne={key:1,class:"no-selection"},ie={key:2,class:"modal-overlay"},ue={class:"modal-content"},re={class:"limit-info"},ce={class:"info-row"},de={class:"info-label"},ve={class:"info-value"},_e={class:"info-row"},fe={class:"info-label"},he={class:"info-value"},me={class:"form-group"},pe={for:"source-allowed"},ge={value:"Yes"},be={value:"No"},we={class:"form-group"},ye={for:"target-allowed"},ke={value:"Yes"},Ce={value:"No"},Ae={class:"form-group"},Ee={for:"transfer-allowed"},Me={value:"Yes"},Pe={value:"No"},Ne={class:"modal-actions"},xe={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},Se=B({__name:"AccountEntityManagement",setup(Le){const P=F(),o=C(()=>P.language==="ar"),L=C(()=>P.darkMode),N=v([]),x=v([]),d=v(""),_=v(!1),g=v(!1),i=v({}),n=v(1),c=v(0),f=v(0);q(async()=>{await V()});async function V(){try{_.value=!0;const l=await M.accountEntities.getEntities();N.value=l.data}catch(l){console.error("Error fetching entities:",l)}finally{_.value=!1}}async function h(l=1){if(d.value)try{_.value=!0;const s=await M.accountEntities.getAccountLimits(d.value,l);x.value=s.results,f.value=s.count,c.value=Math.ceil(s.count/10),n.value=l}catch(s){console.error("Error fetching account limits:",s)}finally{_.value=!1}}function $(l){i.value={...l},g.value=!0}async function Y(){try{await M.accountEntities.updateAccountLimit(i.value.id,{is_transer_allowed_for_source:i.value.is_transer_allowed_for_source,is_transer_allowed_for_target:i.value.is_transer_allowed_for_target,is_transer_allowed:i.value.is_transer_allowed,account_id:i.value.account,entity_id:d.value,source_count:i.value.source_count,target_count:i.value.target_count}),g.value=!1,await h(n.value)}catch(l){console.error("Error updating account limit:",l)}}function T(){n.value<c.value&&h(n.value+1)}function D(){n.value>1&&h(n.value-1)}function I(l){const s=typeof l=="string"?parseInt(l,10):l;s!==n.value&&h(s)}const U=C(()=>{const l=[];if(c.value<=5)for(let a=1;a<=c.value;a++)l.push(a);else{l.push(1);let a=Math.max(2,n.value-1),m=Math.min(c.value-1,n.value+1);n.value<=2?m=Math.min(c.value-1,4):n.value>=c.value-1&&(a=Math.max(2,c.value-5+2)),a>2&&l.push("...");for(let k=a;k<=m;k++)l.push(k);m<c.value-1&&l.push("..."),l.push(c.value)}return l});function y(l){return o.value?l==="Yes"?"نعم":"لا":l}return(l,s)=>(r(),u("div",{class:S(["account-entity-management",{"dark-mode":L.value}])},[e("h1",null,t(o.value?"إدارة الحسابات والكيانات":"Account-Entity Management"),1),e("div",j,[e("div",G,[e("label",J,t(o.value?"مركز التكلفة:":"Cost Center:"),1),e("div",K,[b(e("select",{id:"cost-center","onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:s[1]||(s[1]=a=>h(1))},[e("option",O,t(o.value?"-- اختر مركز التكلفة --":"-- Select Cost Center --"),1),(r(!0),u(A,null,E(N.value,a=>(r(),u("option",{key:a.id,value:a.entity},t(a.alias_default),9,Q))),128))],544),[[w,d.value]])])]),d.value?(r(),u("div",R,t(o.value?`عرض ${(n.value-1)*10+1} - ${Math.min(n.value*10,f.value)} من ${f.value}`:`Showing ${(n.value-1)*10+1} - ${Math.min(n.value*10,f.value)} of ${f.value}`),1)):p("",!0)]),d.value?(r(),u("div",W,[_.value?(r(),u("div",X,t(o.value?"جاري التحميل...":"Loading..."),1)):(r(),u("table",Z,[e("thead",null,[e("tr",null,[s[6]||(s[6]=e("th",null,"ID",-1)),e("th",null,t(o.value?"رقم الحساب":"Account"),1),e("th",null,t(o.value?"مسموح للمصدر":"Source Allowed"),1),e("th",null,t(o.value?"مسموح للهدف":"Target Allowed"),1),e("th",null,t(o.value?"مسموح للنقل":"Transfer Allowed"),1),e("th",null,t(o.value?"الإجراءات":"Actions"),1)])]),e("tbody",null,[(r(!0),u(A,null,E(x.value,a=>(r(),u("tr",{key:a.id},[e("td",null,t(a.id),1),e("td",null,t(a.account),1),e("td",null,t(y(a.is_transer_allowed_for_source)),1),e("td",null,t(y(a.is_transer_allowed_for_target)),1),e("td",null,t(y(a.is_transer_allowed)),1),e("td",null,[e("button",{onClick:m=>$(a),class:"edit-btn"},t(o.value?"تعديل":"Edit"),9,ee)])]))),128))])])),c.value>1?(r(),u("div",te,[e("button",{onClick:D,disabled:n.value===1,class:"pagination-btn"},t(o.value?"السابق":"Previous"),9,ae),e("div",oe,[(r(!0),u(A,null,E(U.value,a=>(r(),u("button",{key:a,onClick:m=>I(a),class:S(["page-number",{active:n.value===a}])},t(a),11,le))),128))]),e("button",{onClick:T,disabled:n.value===c.value,class:"pagination-btn"},t(o.value?"التالي":"Next"),9,se)])):p("",!0)])):p("",!0),!d.value&&!_.value?(r(),u("div",ne,[e("p",null,t(o.value?"الرجاء اختيار مركز تكلفة لعرض حدود الحسابات.":"Please select a cost center to view account limits."),1)])):p("",!0),g.value?(r(),u("div",ie,[e("div",ue,[e("h2",null,t(o.value?"تعديل حدود الحساب":"Edit Account Limit"),1),e("form",{onSubmit:z(Y,["prevent"])},[e("div",re,[e("div",ce,[e("span",de,t(o.value?"رقم الحساب:":"Account:"),1),e("span",ve,t(i.value.account),1)]),e("div",_e,[e("span",fe,t(o.value?"الكيان:":"Entity:"),1),e("span",he,t(d.value),1)])]),e("div",me,[e("label",pe,t(o.value?"مسموح للمصدر:":"Source Allowed:"),1),b(e("select",{id:"source-allowed","onUpdate:modelValue":s[2]||(s[2]=a=>i.value.is_transer_allowed_for_source=a)},[e("option",ge,t(o.value?"نعم":"Yes"),1),e("option",be,t(o.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed_for_source]])]),e("div",we,[e("label",ye,t(o.value?"مسموح للهدف:":"Target Allowed:"),1),b(e("select",{id:"target-allowed","onUpdate:modelValue":s[3]||(s[3]=a=>i.value.is_transer_allowed_for_target=a)},[e("option",ke,t(o.value?"نعم":"Yes"),1),e("option",Ce,t(o.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed_for_target]])]),e("div",Ae,[e("label",Ee,t(o.value?"مسموح للنقل:":"Transfer Allowed:"),1),b(e("select",{id:"transfer-allowed","onUpdate:modelValue":s[4]||(s[4]=a=>i.value.is_transer_allowed=a)},[e("option",Me,t(o.value?"نعم":"Yes"),1),e("option",Pe,t(o.value?"لا":"No"),1)],512),[[w,i.value.is_transer_allowed]])]),e("div",Ne,[e("button",{type:"button",onClick:s[5]||(s[5]=a=>g.value=!1),class:"cancel-btn"},t(o.value?"إلغاء":"Cancel"),1),e("button",xe,t(o.value?"حفظ":"Save"),1)])],32)])])):p("",!0)],2))}}),Ye=H(Se,[["__scopeId","data-v-8bc4398c"]]);export{Ye as default};
