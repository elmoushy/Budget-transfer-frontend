import{d as K,u as O,z as k,r as v,o as Q,s as P,e as u,f as e,h,t,b as w,I as C,F as S,D as x,v as R,n as T,m as W,q as i,y as X}from"./index-B1Dgt89H.js";const Z={class:"filter-section"},ee={class:"filter-container"},te={for:"cost-center"},ae={class:"select-container"},le={value:"",disabled:""},oe=["value"],se={key:0,class:"pagination-info"},ne={key:0,class:"search-status"},ue={key:0,class:"search-section"},ie={class:"search-container"},ce={for:"account-search"},re={class:"search-input-container"},de=["placeholder"],ve={key:1,class:"account-limits-container"},_e={key:0,class:"loading-indicator"},he={key:1,class:"limits-table"},fe=["onClick"],me={key:2,class:"pagination"},pe=["disabled"],ge={class:"page-numbers"},be=["onClick"],we=["disabled"],ye={key:2,class:"no-selection"},ke={key:3,class:"modal-overlay"},Ce={class:"modal-content"},Ae={class:"limit-info"},Ee={class:"info-row"},Me={class:"info-label"},Pe={class:"info-value"},Se={class:"info-row"},xe={class:"info-label"},Le={class:"info-value"},Ne={class:"form-group"},Ve={for:"source-allowed"},$e={value:"Yes"},Te={value:"No"},Ie={class:"form-group"},Ye={for:"target-allowed"},De={value:"Yes"},Ue={value:"No"},Be={class:"form-group"},ze={for:"transfer-allowed"},Fe={value:"Yes"},qe={value:"No"},je={class:"modal-actions"},Ge={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},L=10,He=K({__name:"AccountEntityManagement",setup(Je){const N=O(),o=k(()=>N.language==="ar"),I=k(()=>N.darkMode),V=v([]),A=v([]),E=v([]),_=v(""),m=v(!1),y=v(!1),c=v({}),d=v(""),n=v(1),r=v(0),p=v(0);Q(async()=>{await D()});function Y(){d.value="",n.value=1,$()}async function D(){try{m.value=!0;const l=await P.accountEntities.getEntities();V.value=l.data}catch(l){console.error("Error fetching entities:",l)}finally{m.value=!1}}async function $(){if(_.value)try{m.value=!0;const l=await P.accountEntities.getAccountLimits(_.value,1);E.value=l.results,g()}catch(l){console.error("Error fetching account limits:",l),E.value=[],A.value=[],p.value=0,r.value=0}finally{m.value=!1}}function U(l){c.value={...l},y.value=!0}async function B(){try{await P.accountEntities.updateAccountLimit(c.value.id,{is_transer_allowed_for_source:c.value.is_transer_allowed_for_source,is_transer_allowed_for_target:c.value.is_transer_allowed_for_target,is_transer_allowed:c.value.is_transer_allowed,account_id:c.value.account,entity_id:_.value,source_count:c.value.source_count,target_count:c.value.target_count}),y.value=!1,await $()}catch(l){console.error("Error updating account limit:",l)}}function z(){n.value<r.value&&(n.value++,g())}function F(){n.value>1&&(n.value--,g())}function q(l){const s=typeof l=="string"?parseInt(l,10):l;s!==n.value&&s>=1&&s<=r.value&&(n.value=s,g())}const j=k(()=>{const l=[];if(r.value<=5)for(let a=1;a<=r.value;a++)l.push(a);else{l.push(1);let a=Math.max(2,n.value-1),f=Math.min(r.value-1,n.value+1);n.value<=2?f=Math.min(r.value-1,4):n.value>=r.value-1&&(a=Math.max(2,r.value-5+2)),a>2&&l.push("...");for(let b=a;b<=f;b++)l.push(b);f<r.value-1&&l.push("..."),l.push(r.value)}return l}),G=k(()=>d.value.trim()?o.value?`البحث عن: "${d.value}"`:`Searching for: "${d.value}"`:"");function M(l){return o.value?l==="Yes"?"نعم":"لا":l}function H(){n.value=1,g()}function J(){d.value="",n.value=1,g()}function g(){let l=[...E.value];if(d.value.trim()){const f=d.value.toLowerCase();l=l.filter(b=>b.account.toLowerCase().includes(f))}p.value=l.length,r.value=Math.ceil(l.length/L);const s=(n.value-1)*L,a=s+L;A.value=l.slice(s,a)}return(l,s)=>(i(),u("div",{class:T(["account-entity-management",{"dark-mode":I.value}])},[e("h1",null,t(o.value?"إدارة الحسابات والكيانات":"Account-Entity Management"),1),e("div",Z,[e("div",ee,[e("label",te,t(o.value?"مركز التكلفة:":"Cost Center:"),1),e("div",ae,[w(e("select",{id:"cost-center","onUpdate:modelValue":s[0]||(s[0]=a=>_.value=a),onChange:Y},[e("option",le,t(o.value?"-- اختر مركز التكلفة --":"-- Select Cost Center --"),1),(i(!0),u(S,null,x(V.value,a=>(i(),u("option",{key:a.id,value:a.entity},t(a.alias_default),9,oe))),128))],544),[[C,_.value]])])]),_.value?(i(),u("div",se,[e("div",null,t(o.value?`عرض ${(n.value-1)*10+1} - ${Math.min(n.value*10,p.value)} من ${p.value}`:`Showing ${(n.value-1)*10+1} - ${Math.min(n.value*10,p.value)} of ${p.value}`),1),d.value.trim()?(i(),u("div",ne,t(G.value),1)):h("",!0)])):h("",!0)]),_.value?(i(),u("div",ue,[e("div",ie,[e("label",ce,t(o.value?"البحث في الحسابات:":"Search Accounts:"),1),e("div",re,[w(e("input",{id:"account-search","onUpdate:modelValue":s[1]||(s[1]=a=>d.value=a),type:"text",placeholder:o.value?"ادخل رقم الحساب للبحث...":"Enter account number to search...",onInput:H},null,40,de),[[R,d.value]]),d.value?(i(),u("button",{key:0,onClick:J,class:"clear-search-btn"},"✕")):h("",!0)])])])):h("",!0),_.value?(i(),u("div",ve,[m.value?(i(),u("div",_e,t(o.value?"جاري التحميل...":"Loading..."),1)):(i(),u("table",he,[e("thead",null,[e("tr",null,[s[6]||(s[6]=e("th",null,"ID",-1)),e("th",null,t(o.value?"رقم الحساب":"Account"),1),e("th",null,t(o.value?"مسموح للمصدر":"Source Allowed"),1),e("th",null,t(o.value?"مسموح للهدف":"Target Allowed"),1),e("th",null,t(o.value?"مسموح للنقل":"Transfer Allowed"),1),e("th",null,t(o.value?"الإجراءات":"Actions"),1)])]),e("tbody",null,[(i(!0),u(S,null,x(A.value,a=>(i(),u("tr",{key:a.id},[e("td",null,t(a.id),1),e("td",null,t(a.account),1),e("td",null,t(M(a.is_transer_allowed_for_source)),1),e("td",null,t(M(a.is_transer_allowed_for_target)),1),e("td",null,t(M(a.is_transer_allowed)),1),e("td",null,[e("button",{onClick:f=>U(a),class:"edit-btn"},t(o.value?"تعديل":"Edit"),9,fe)])]))),128))])])),r.value>1?(i(),u("div",me,[e("button",{onClick:F,disabled:n.value===1,class:"pagination-btn"},t(o.value?"السابق":"Previous"),9,pe),e("div",ge,[(i(!0),u(S,null,x(j.value,a=>(i(),u("button",{key:a,onClick:f=>q(a),class:T(["page-number",{active:n.value===a}])},t(a),11,be))),128))]),e("button",{onClick:z,disabled:n.value===r.value,class:"pagination-btn"},t(o.value?"التالي":"Next"),9,we)])):h("",!0)])):h("",!0),!_.value&&!m.value?(i(),u("div",ye,[e("p",null,t(o.value?"الرجاء اختيار مركز تكلفة لعرض حدود الحسابات.":"Please select a cost center to view account limits."),1)])):h("",!0),y.value?(i(),u("div",ke,[e("div",Ce,[e("h2",null,t(o.value?"تعديل حدود الحساب":"Edit Account Limit"),1),e("form",{onSubmit:W(B,["prevent"])},[e("div",Ae,[e("div",Ee,[e("span",Me,t(o.value?"رقم الحساب:":"Account:"),1),e("span",Pe,t(c.value.account),1)]),e("div",Se,[e("span",xe,t(o.value?"الكيان:":"Entity:"),1),e("span",Le,t(_.value),1)])]),e("div",Ne,[e("label",Ve,t(o.value?"مسموح للمصدر:":"Source Allowed:"),1),w(e("select",{id:"source-allowed","onUpdate:modelValue":s[2]||(s[2]=a=>c.value.is_transer_allowed_for_source=a)},[e("option",$e,t(o.value?"نعم":"Yes"),1),e("option",Te,t(o.value?"لا":"No"),1)],512),[[C,c.value.is_transer_allowed_for_source]])]),e("div",Ie,[e("label",Ye,t(o.value?"مسموح للهدف:":"Target Allowed:"),1),w(e("select",{id:"target-allowed","onUpdate:modelValue":s[3]||(s[3]=a=>c.value.is_transer_allowed_for_target=a)},[e("option",De,t(o.value?"نعم":"Yes"),1),e("option",Ue,t(o.value?"لا":"No"),1)],512),[[C,c.value.is_transer_allowed_for_target]])]),e("div",Be,[e("label",ze,t(o.value?"مسموح للنقل:":"Transfer Allowed:"),1),w(e("select",{id:"transfer-allowed","onUpdate:modelValue":s[4]||(s[4]=a=>c.value.is_transer_allowed=a)},[e("option",Fe,t(o.value?"نعم":"Yes"),1),e("option",qe,t(o.value?"لا":"No"),1)],512),[[C,c.value.is_transer_allowed]])]),e("div",je,[e("button",{type:"button",onClick:s[5]||(s[5]=a=>y.value=!1),class:"cancel-btn"},t(o.value?"إلغاء":"Cancel"),1),e("button",Ge,t(o.value?"حفظ":"Save"),1)])],32)])])):h("",!0)],2))}}),Oe=X(He,[["__scopeId","data-v-99f6d4eb"]]);export{Oe as default};
