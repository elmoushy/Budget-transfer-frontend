import{d as ae,u as oe,y as j,r as u,o as ne,e as n,f as e,h as v,t as s,n as L,b as d,v as p,E as C,F as f,B as b,i as re,p as P,s as r,_ as ue}from"./index-CJ1Bdu0i.js";import{a as y}from"./apiService-yYtdez-Z.js";import"./api-DjaIqDLJ.js";const ie={class:"tabs-container"},de={key:1,class:"tab-content"},ve={class:"actions"},ce={class:"search-filters"},_e={class:"search-container"},me=["placeholder"],he={class:"filter-container"},pe={value:""},fe={value:"admin"},be={value:"user"},ye={value:""},ge={value:"None"},Ue=["value"],ke={class:"action-buttons"},we=["disabled"],Le={key:0,class:"loading-spinner"},Ce={class:"user-list-container"},Ee={key:0,class:"loading-indicator"},Se={key:1,class:"table-container"},$e={class:"table-summary"},Ae={class:"user-count"},Ne={class:"user-table"},Ve={class:"actions-cell"},De=["onClick"],Me=["onClick"],xe={key:0},qe={colspan:"5",class:"no-results"},Re={key:2,class:"tab-content"},Te={class:"user-list-container"},Be={key:0,class:"loading-indicator"},Fe={key:1,class:"table-container"},Ie={class:"user-table"},Oe={class:"actions-cell"},Pe=["onClick"],ze={key:3,class:"tab-content"},Qe={class:"assignment-container"},je={class:"card"},Ge={class:"form-group"},He={for:"user-select"},Je={value:"",disabled:""},Ke=["value"],We={class:"form-group"},Xe={for:"level-select"},Ye={value:"",disabled:""},Ze=["value"],es={type:"submit",class:"submit-btn assign-btn"},ss={class:"card users-by-level"},ls={class:"level-header"},ts={class:"level-count"},as={class:"users-list"},os={key:0,class:"no-users"},ns={key:4,class:"modal-overlay"},rs={class:"modal-content"},us={class:"form-group"},is={for:"username"},ds={class:"form-group"},vs={for:"password"},cs={class:"form-group"},_s={for:"role"},ms={value:"admin"},hs={value:"user"},ps={class:"modal-actions"},fs={type:"submit",class:"submit-btn"},bs={key:5,class:"modal-overlay"},ys={class:"modal-content"},gs={class:"form-group"},Us={for:"edit-username"},ks={class:"form-group"},ws={for:"edit-role"},Ls={value:"admin"},Cs={value:"user"},Es={class:"modal-actions"},Ss={type:"submit",class:"submit-btn"},$s={key:6,class:"modal-overlay"},As={class:"modal-content"},Ns={class:"form-group"},Vs={for:"edit-level-name"},Ds={class:"form-group"},Ms={for:"edit-level-description"},xs={class:"form-group"},qs={for:"edit-level-order"},Rs={class:"modal-actions"},Ts={type:"submit",class:"submit-btn"},Bs={key:7,class:"modal-overlay"},Fs={class:"modal-content"},Is={class:"modal-actions"},Os=ae({__name:"UserManagement",setup(Ps){const G=oe(),t=j(()=>G.language==="ar"),K=j(()=>G.darkMode),_=u("users"),g=u([]),E=u(!0),U=u([]),S=u(!0),$=u(""),A=u(""),M=u(""),x=u(""),N=u(""),q=u(!1),R=u(!1),T=u(!1),B=u(!1),m=u({username:"",password:"",role:"user"}),h=u({id:null,username:"",role:""}),c=u({id:null,name:"",description:"",level_order:0}),k=u(null),F=u(""),H=u(!0);ne(async()=>{await J()});async function J(){try{await Promise.all([V(),z()]),i("Data refreshed successfully")}catch(o){console.error("Error refreshing data:",o),i("Error refreshing data",!1)}}async function V(){try{E.value=!0;const o=await y.auth.getUsers();g.value=o}catch(o){console.error("Error fetching users:",o),i("Error fetching users",!1)}finally{E.value=!1}}async function z(){try{S.value=!0;const o=await y.auth.getUserLevels();U.value=o,U.value.sort((a,w)=>a.level_order-w.level_order)}catch(o){console.error("Error fetching user levels:",o),i("Error fetching user levels",!1)}finally{S.value=!1}}function i(o,a=!0){F.value=o,H.value=a,setTimeout(()=>{F.value=""},3e3)}async function W(){try{await y.auth.registerUser(m.value),m.value={username:"",password:"",role:"user"},q.value=!1,await V(),i("User added successfully")}catch(o){console.error("Error adding user:",o),i("Error adding user",!1)}}function X(o){h.value={id:o.id,username:o.username,role:o.role},R.value=!0}async function Y(){try{await y.auth.updateUser(h.value.id,{username:h.value.username,role:h.value.role}),R.value=!1,await V(),i("User updated successfully")}catch(o){console.error("Error updating user:",o),i("Error updating user",!1)}}function Z(o){k.value={id:o.id,username:o.username},T.value=!0}async function ee(){if(k.value)try{await y.auth.deleteUser(k.value.id),T.value=!1,k.value=null,await V(),i("User deleted successfully")}catch(o){console.error("Error deleting user:",o),i("Error deleting user",!1)}}function se(o){c.value={id:o.id,name:o.name,description:o.description,level_order:o.level_order},B.value=!0}async function le(){try{await y.auth.updateUserLevel(c.value.id,{name:c.value.name,description:c.value.description}),B.value=!1,await z(),i("Level updated successfully")}catch(o){console.error("Error updating level:",o),i("Error updating level",!1)}}async function te(){if(!(!$.value||!A.value))try{await y.auth.assignUserLevel($.value,A.value),$.value="",A.value="",await Promise.all([V(),z()]),i("User level assigned successfully")}catch(o){console.error("Error assigning user level:",o),i("Error assigning user level",!1)}}function Q(o){return g.value.filter(a=>a.user_level===o)}const I=j(()=>g.value.filter(o=>{const a=M.value===""||o.username.toLowerCase().includes(M.value.toLowerCase()),w=x.value===""||o.role===x.value,O=N.value===""||N.value==="None"&&o.user_level==="None"||o.user_level===N.value;return a&&w&&O}));return(o,a)=>{var w,O;return r(),n("div",{class:L(["user-management",{"dark-mode":K.value}])},[e("h1",null,s(t.value?"ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"User Management"),1),F.value?(r(),n("div",{key:0,class:L(["feedback-message",H.value?"success":"error"])},s(F.value),3)):v("",!0),e("div",ie,[e("button",{class:L(["tab-btn",{active:_.value==="users"}]),onClick:a[0]||(a[0]=l=>_.value="users")},s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"Users"),3),e("button",{class:L(["tab-btn",{active:_.value==="levels"}]),onClick:a[1]||(a[1]=l=>_.value="levels")},s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™":"User Levels"),3),e("button",{class:L(["tab-btn",{active:_.value==="assignments"}]),onClick:a[2]||(a[2]=l=>_.value="assignments")},s(t.value?"ÿßŸÑÿ™ÿπŸäŸäŸÜÿßÿ™":"Level Assignments"),3)]),_.value==="users"?(r(),n("div",de,[e("div",ve,[e("div",ce,[e("div",_e,[d(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=l=>M.value=l),placeholder:t.value?"ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖ...":"Search users...",class:"search-input"},null,8,me),[[p,M.value]]),a[21]||(a[21]=e("span",{class:"search-icon"},"üîç",-1))]),e("div",he,[d(e("select",{"onUpdate:modelValue":a[4]||(a[4]=l=>x.value=l),class:"filter-select"},[e("option",pe,s(t.value?"ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿØŸàÿßÿ±":"All Roles"),1),e("option",fe,s(t.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",be,s(t.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,x.value]]),d(e("select",{"onUpdate:modelValue":a[5]||(a[5]=l=>N.value=l),class:"filter-select"},[e("option",ye,s(t.value?"ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™":"All Levels"),1),e("option",ge,s(t.value?"ÿ®ÿØŸàŸÜ ŸÖÿ≥ÿ™ŸàŸâ":"No Level"),1),(r(!0),n(f,null,b(U.value,l=>(r(),n("option",{key:l.id,value:l.name},s(l.name),9,Ue))),128))],512),[[C,N.value]])])]),e("div",ke,[e("button",{onClick:J,class:"refresh-btn",disabled:E.value||S.value},[re(s(t.value?"ÿ™ÿ≠ÿØŸäÿ´":"Refresh")+" ",1),E.value||S.value?(r(),n("span",Le)):v("",!0)],8,we),e("button",{onClick:a[6]||(a[6]=l=>q.value=!0),class:"add-user-btn"},s(t.value?"ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ":"Add New User"),1)])]),e("div",Ce,[E.value?(r(),n("div",Ee,s(t.value?"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...":"Loading..."),1)):(r(),n("div",Se,[e("div",$e,[e("span",Ae,s(t.value?`ÿ•ÿ¨ŸÖÿßŸÑŸä: ${I.value.length} ŸÖŸÜ ${g.value.length} ŸÖÿ≥ÿ™ÿÆÿØŸÖ`:`Total: ${I.value.length} of ${g.value.length} users`),1)]),e("table",Ne,[e("thead",null,[e("tr",null,[a[22]||(a[22]=e("th",null,"ID",-1)),e("th",null,s(t.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),e("th",null,s(t.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),e("th",null,s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"User Level"),1),e("th",null,s(t.value?"ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™":"Actions"),1)])]),e("tbody",null,[(r(!0),n(f,null,b(I.value,l=>(r(),n("tr",{key:l.id},[e("td",null,s(l.id),1),e("td",null,s(l.username),1),e("td",null,[e("span",{class:L(["role-badge",l.role])},s(l.role),3)]),e("td",null,s(l.user_level!=="None"?l.user_level:"-"),1),e("td",Ve,[e("button",{onClick:D=>X(l),class:"edit-btn"},s(t.value?"ÿ™ÿπÿØŸäŸÑ":"Edit"),9,De),e("button",{onClick:D=>Z(l),class:"delete-btn"},s(t.value?"ÿ≠ÿ∞ŸÅ":"Delete"),9,Me)])]))),128)),I.value.length===0?(r(),n("tr",xe,[e("td",qe,s(t.value?"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨ ŸÖÿ∑ÿßÿ®ŸÇÿ©":"No matching results found"),1)])):v("",!0)])])]))])])):v("",!0),_.value==="levels"?(r(),n("div",Re,[e("div",Te,[S.value?(r(),n("div",Be,s(t.value?"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...":"Loading..."),1)):(r(),n("div",Fe,[e("table",Ie,[e("thead",null,[e("tr",null,[a[23]||(a[23]=e("th",null,"ID",-1)),e("th",null,s(t.value?"ÿßŸÑÿßÿ≥ŸÖ":"Name"),1),e("th",null,s(t.value?"ÿßŸÑŸàÿµŸÅ":"Description"),1),e("th",null,s(t.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order"),1),e("th",null,s(t.value?"ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™":"Actions"),1)])]),e("tbody",null,[(r(!0),n(f,null,b(U.value,l=>(r(),n("tr",{key:l.id},[e("td",null,s(l.id),1),e("td",null,s(l.name),1),e("td",null,s(l.description),1),e("td",null,s(l.level_order),1),e("td",Oe,[e("button",{onClick:D=>se(l),class:"edit-btn"},s(t.value?"ÿ™ÿπÿØŸäŸÑ":"Edit"),9,Pe)])]))),128))])])]))])])):v("",!0),_.value==="assignments"?(r(),n("div",ze,[e("div",Qe,[e("div",je,[e("h3",null,s(t.value?"ÿ™ÿπŸäŸäŸÜ ŸÖÿ≥ÿ™ŸàŸâ ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Assign User Level"),1),e("form",{onSubmit:P(te,["prevent"])},[e("div",Ge,[e("label",He,s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1),d(e("select",{id:"user-select","onUpdate:modelValue":a[7]||(a[7]=l=>$.value=l),required:""},[e("option",Je,s(t.value?"ÿßÿÆÿ™ÿ± ŸÖÿ≥ÿ™ÿÆÿØŸÖŸãÿß":"Select a user"),1),(r(!0),n(f,null,b(g.value,l=>(r(),n("option",{key:l.id,value:l.id},s(l.username)+" ("+s(l.user_level!=="None"?l.user_level:t.value?"ÿ∫Ÿäÿ± ŸÖÿπŸäŸÜ":"Not assigned")+") ",9,Ke))),128))],512),[[C,$.value]])]),e("div",We,[e("label",Xe,s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Level"),1),d(e("select",{id:"level-select","onUpdate:modelValue":a[8]||(a[8]=l=>A.value=l),required:""},[e("option",Ye,s(t.value?"ÿßÿÆÿ™ÿ± ŸÖÿ≥ÿ™ŸàŸâ":"Select a level"),1),(r(!0),n(f,null,b(U.value,l=>(r(),n("option",{key:l.id,value:l.level_order},s(l.name)+" ("+s(t.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order")+": "+s(l.level_order)+") ",9,Ze))),128))],512),[[C,A.value]])]),e("button",es,s(t.value?"ÿ™ÿπŸäŸäŸÜ":"Assign"),1)],32)]),e("div",ss,[e("h3",null,s(t.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Users by Level"),1),(r(!0),n(f,null,b(U.value,l=>(r(),n("div",{key:l.id,class:"level-group"},[e("div",ls,[e("h4",null,s(l.name),1),e("span",ts,s(Q(l.name).length)+" "+s(t.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"users"),1)]),e("ul",as,[(r(!0),n(f,null,b(Q(l.name),D=>(r(),n("li",{key:D.id},s(D.username),1))),128)),Q(l.name).length===0?(r(),n("li",os,s(t.value?"ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"No users"),1)):v("",!0)])]))),128))])])])):v("",!0),q.value?(r(),n("div",ns,[e("div",rs,[e("h2",null,s(t.value?"ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ":"Add New User"),1),e("form",{onSubmit:P(W,["prevent"])},[e("div",us,[e("label",is,s(t.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),d(e("input",{type:"text",id:"username","onUpdate:modelValue":a[9]||(a[9]=l=>m.value.username=l),required:""},null,512),[[p,m.value.username]])]),e("div",ds,[e("label",vs,s(t.value?"ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±":"Password"),1),d(e("input",{type:"password",id:"password","onUpdate:modelValue":a[10]||(a[10]=l=>m.value.password=l),required:""},null,512),[[p,m.value.password]])]),e("div",cs,[e("label",_s,s(t.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),d(e("select",{id:"role","onUpdate:modelValue":a[11]||(a[11]=l=>m.value.role=l),required:""},[e("option",ms,s(t.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",hs,s(t.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,m.value.role]])]),e("div",ps,[e("button",{type:"button",onClick:a[12]||(a[12]=l=>q.value=!1),class:"cancel-btn"},s(t.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",fs,s(t.value?"ÿ•ÿ∂ÿßŸÅÿ©":"Add"),1)])],32)])])):v("",!0),R.value?(r(),n("div",bs,[e("div",ys,[e("h2",null,s(t.value?"ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Edit User"),1),e("form",{onSubmit:P(Y,["prevent"])},[e("div",gs,[e("label",Us,s(t.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),d(e("input",{type:"text",id:"edit-username","onUpdate:modelValue":a[13]||(a[13]=l=>h.value.username=l),required:""},null,512),[[p,h.value.username]])]),e("div",ks,[e("label",ws,s(t.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),d(e("select",{id:"edit-role","onUpdate:modelValue":a[14]||(a[14]=l=>h.value.role=l),required:""},[e("option",Ls,s(t.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",Cs,s(t.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,h.value.role]])]),e("div",Es,[e("button",{type:"button",onClick:a[15]||(a[15]=l=>R.value=!1),class:"cancel-btn"},s(t.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",Ss,s(t.value?"ÿ≠ŸÅÿ∏":"Save"),1)])],32)])])):v("",!0),B.value?(r(),n("div",$s,[e("div",As,[e("h2",null,s(t.value?"ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Edit Level"),1),e("form",{onSubmit:P(le,["prevent"])},[e("div",Ns,[e("label",Vs,s(t.value?"ÿßŸÑÿßÿ≥ŸÖ":"Name"),1),d(e("input",{type:"text",id:"edit-level-name","onUpdate:modelValue":a[16]||(a[16]=l=>c.value.name=l),required:""},null,512),[[p,c.value.name]])]),e("div",Ds,[e("label",Ms,s(t.value?"ÿßŸÑŸàÿµŸÅ":"Description"),1),d(e("textarea",{id:"edit-level-description","onUpdate:modelValue":a[17]||(a[17]=l=>c.value.description=l),rows:"3"},null,512),[[p,c.value.description]])]),e("div",xs,[e("label",qs,s(t.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order"),1),d(e("input",{type:"number",id:"edit-level-order","onUpdate:modelValue":a[18]||(a[18]=l=>c.value.level_order=l),readonly:"",disabled:""},null,512),[[p,c.value.level_order]]),e("small",null,s(t.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ® ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ÿ∫ŸäŸäÿ±Ÿá":"Order cannot be changed"),1)]),e("div",Rs,[e("button",{type:"button",onClick:a[19]||(a[19]=l=>B.value=!1),class:"cancel-btn"},s(t.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",Ts,s(t.value?"ÿ≠ŸÅÿ∏":"Save"),1)])],32)])])):v("",!0),T.value?(r(),n("div",Bs,[e("div",Fs,[e("h2",null,s(t.value?"ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≠ÿ∞ŸÅ":"Confirm Delete"),1),e("p",null,s(t.value?`ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ "${(w=k.value)==null?void 0:w.username}"ÿü`:`Are you sure you want to delete user "${(O=k.value)==null?void 0:O.username}"?`),1),e("div",Is,[e("button",{onClick:a[20]||(a[20]=l=>T.value=!1),class:"cancel-btn"},s(t.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",{onClick:ee,class:"delete-confirm-btn"},s(t.value?"ÿ≠ÿ∞ŸÅ":"Delete"),1)])])])):v("",!0)],2)}}}),Gs=ue(Os,[["__scopeId","data-v-a506051f"]]);export{Gs as default};
