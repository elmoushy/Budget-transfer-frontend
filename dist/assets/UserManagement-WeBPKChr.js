import{d as ae,u as oe,y as Q,r as u,o as ne,e as n,f as e,h as v,t as s,n as L,b as d,v as p,H as C,F as f,C as b,i as re,m as P,q as r,s as ue}from"./index-DKsQNwYd.js";import{a as y}from"./apiService-Bs_XDTQg.js";const ie={class:"tabs-container"},de={key:1,class:"tab-content"},ce={class:"actions"},ve={class:"search-filters"},_e={class:"search-container"},me=["placeholder"],he={class:"filter-container"},pe={value:""},fe={value:"admin"},be={value:"user"},ye={value:""},ge={value:"None"},Ue=["value"],ke={class:"action-buttons"},we=["disabled"],Le={key:0,class:"loading-spinner"},Ce={class:"user-list-container"},Ee={key:0,class:"loading-indicator"},Se={key:1,class:"table-container"},$e={class:"table-summary"},Ae={class:"user-count"},Ne={class:"user-table"},Ve={style:{"text-align":"center"}},Me={class:"actions-cell"},De=["onClick"],xe=["onClick"],qe={key:0},Re={colspan:"5",class:"no-results"},Te={key:2,class:"tab-content"},Fe={class:"user-list-container"},Be={key:0,class:"loading-indicator"},Ie={key:1,class:"table-container"},Oe={class:"user-table"},Pe={style:{"text-align":"center"}},ze={class:"actions-cell"},He=["onClick"],Qe={key:3,class:"tab-content"},je={class:"assignment-container"},Ge={class:"card"},Je={class:"form-group"},Ke={for:"user-select"},We={value:"",disabled:""},Xe=["value"],Ye={class:"form-group"},Ze={for:"level-select"},es={value:"",disabled:""},ss=["value"],ts={type:"submit",class:"submit-btn assign-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},ls={class:"card users-by-level"},as={class:"level-header"},os={class:"level-count"},ns={class:"users-list"},rs={key:0,class:"no-users"},us={key:4,class:"modal-overlay"},is={class:"modal-content"},ds={class:"form-group"},cs={for:"username"},vs={class:"form-group"},_s={for:"password"},ms={class:"form-group"},hs={for:"role"},ps={value:"admin"},fs={value:"user"},bs={class:"modal-actions"},ys={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},gs={key:5,class:"modal-overlay"},Us={class:"modal-content"},ks={class:"form-group"},ws={for:"edit-username"},Ls={class:"form-group"},Cs={for:"edit-role"},Es={value:"admin"},Ss={value:"user"},$s={class:"modal-actions"},As={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},Ns={key:6,class:"modal-overlay"},Vs={class:"modal-content"},Ms={class:"form-group"},Ds={for:"edit-level-name"},xs={class:"form-group"},qs={for:"edit-level-description"},Rs={class:"form-group"},Ts={for:"edit-level-order"},Fs={class:"modal-actions"},Bs={type:"submit",class:"submit-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},Is={key:7,class:"modal-overlay"},Os={class:"modal-content"},Ps={class:"modal-actions"},zs=ae({__name:"UserManagement",setup(Hs){const j=oe(),l=Q(()=>j.language==="ar"),K=Q(()=>j.darkMode),_=u("users"),g=u([]),E=u(!0),U=u([]),S=u(!0),$=u(""),A=u(""),D=u(""),x=u(""),N=u(""),q=u(!1),R=u(!1),T=u(!1),F=u(!1),m=u({username:"",password:"",role:"user"}),h=u({id:null,username:"",role:""}),c=u({id:null,name:"",description:"",level_order:0}),k=u(null),B=u(""),G=u(!0);ne(async()=>{await J()});async function J(){try{await Promise.all([V(),z()]),i("Data refreshed successfully")}catch(o){console.error("Error refreshing data:",o),i("Error refreshing data",!1)}}async function V(){try{E.value=!0;const o=await y.auth.getUsers();g.value=o}catch(o){console.error("Error fetching users:",o),i("Error fetching users",!1)}finally{E.value=!1}}async function z(){try{S.value=!0;const o=await y.auth.getUserLevels();U.value=o,U.value.sort((a,w)=>a.level_order-w.level_order)}catch(o){console.error("Error fetching user levels:",o),i("Error fetching user levels",!1)}finally{S.value=!1}}function i(o,a=!0){B.value=o,G.value=a,setTimeout(()=>{B.value=""},3e3)}async function W(){try{await y.auth.registerUser(m.value),m.value={username:"",password:"",role:"user"},q.value=!1,await V(),i("User added successfully")}catch(o){console.error("Error adding user:",o),i("Error adding user",!1)}}function X(o){h.value={id:o.id,username:o.username,role:o.role},R.value=!0}async function Y(){try{await y.auth.updateUser(h.value.id,{username:h.value.username,role:h.value.role}),R.value=!1,await V(),i("User updated successfully")}catch(o){console.error("Error updating user:",o),i("Error updating user",!1)}}function Z(o){k.value={id:o.id,username:o.username},T.value=!0}async function ee(){if(k.value)try{await y.auth.deleteUser(k.value.id),T.value=!1,k.value=null,await V(),i("User deleted successfully")}catch(o){console.error("Error deleting user:",o),i("Error deleting user",!1)}}function se(o){c.value={id:o.id,name:o.name,description:o.description,level_order:o.level_order},F.value=!0}async function te(){try{await y.auth.updateUserLevel(c.value.id,{name:c.value.name,description:c.value.description,level_order:c.value.level_order}),F.value=!1,await z(),i("Level updated successfully")}catch(o){console.error("Error updating level:",o),i("Error updating level",!1)}}async function le(){if(!(!$.value||!A.value))try{await y.auth.assignUserLevel($.value,A.value),$.value="",A.value="",await Promise.all([V(),z()]),i("User level assigned successfully")}catch(o){console.error("Error assigning user level:",o),i("Error assigning user level",!1)}}function H(o){return g.value.filter(a=>a.user_level===o)}const I=Q(()=>g.value.filter(o=>{const a=D.value===""||o.username.toLowerCase().includes(D.value.toLowerCase()),w=x.value===""||o.role===x.value,O=N.value===""||N.value==="None"&&o.user_level==="None"||o.user_level===N.value;return a&&w&&O}));return(o,a)=>{var w,O;return r(),n("div",{class:L(["user-management",{"dark-mode":K.value}])},[e("h1",null,s(l.value?"ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"User Management"),1),B.value?(r(),n("div",{key:0,class:L(["feedback-message",G.value?"success":"error"])},s(B.value),3)):v("",!0),e("div",ie,[e("button",{class:L(["tab-btn",{active:_.value==="users"}]),onClick:a[0]||(a[0]=t=>_.value="users")},s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"Users"),3),e("button",{class:L(["tab-btn",{active:_.value==="levels"}]),onClick:a[1]||(a[1]=t=>_.value="levels")},s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™":"User Levels"),3),e("button",{class:L(["tab-btn",{active:_.value==="assignments"}]),onClick:a[2]||(a[2]=t=>_.value="assignments")},s(l.value?"ÿßŸÑÿ™ÿπŸäŸäŸÜÿßÿ™":"Level Assignments"),3)]),_.value==="users"?(r(),n("div",de,[e("div",ce,[e("div",ve,[e("div",_e,[d(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=t=>D.value=t),placeholder:l.value?"ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖ...":"Search users...",class:"search-input"},null,8,me),[[p,D.value]]),a[21]||(a[21]=e("span",{class:"search-icon"},"üîç",-1))]),e("div",he,[d(e("select",{"onUpdate:modelValue":a[4]||(a[4]=t=>x.value=t),class:"filter-select"},[e("option",pe,s(l.value?"ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿØŸàÿßÿ±":"All Roles"),1),e("option",fe,s(l.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",be,s(l.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,x.value]]),d(e("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>N.value=t),class:"filter-select"},[e("option",ye,s(l.value?"ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™":"All Levels"),1),e("option",ge,s(l.value?"ÿ®ÿØŸàŸÜ ŸÖÿ≥ÿ™ŸàŸâ":"No Level"),1),(r(!0),n(f,null,b(U.value,t=>(r(),n("option",{key:t.id,value:t.name},s(t.name),9,Ue))),128))],512),[[C,N.value]])])]),e("div",ke,[e("button",{onClick:J,class:"refresh-btn",disabled:E.value||S.value},[re(s(l.value?"ÿ™ÿ≠ÿØŸäÿ´":"Refresh")+" ",1),E.value||S.value?(r(),n("span",Le)):v("",!0)],8,we),e("button",{onClick:a[6]||(a[6]=t=>q.value=!0),class:"add-user-btn",style:{"background-color":"#4caf50 !important",color:"white !important"}},s(l.value?"ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ":"Add New User"),1)])]),e("div",Ce,[E.value?(r(),n("div",Ee,s(l.value?"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...":"Loading..."),1)):(r(),n("div",Se,[e("div",$e,[e("span",Ae,s(l.value?`ÿ•ÿ¨ŸÖÿßŸÑŸä: ${I.value.length} ŸÖŸÜ ${g.value.length} ŸÖÿ≥ÿ™ÿÆÿØŸÖ`:`Total: ${I.value.length} of ${g.value.length} users`),1)]),e("table",Ne,[e("thead",null,[e("tr",null,[e("th",null,s(l.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),e("th",null,s(l.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),e("th",null,s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"User Level"),1),e("th",Ve,s(l.value?"ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™":"Actions"),1)])]),e("tbody",null,[(r(!0),n(f,null,b(I.value,t=>(r(),n("tr",{key:t.id},[e("td",null,s(t.username),1),e("td",null,[e("span",{class:L(["role-badge",t.role])},s(t.role),3)]),e("td",null,s(t.user_level!=="None"?t.user_level:"-"),1),e("td",Me,[e("button",{onClick:M=>X(t),class:"edit-btn"},s(l.value?"ÿ™ÿπÿØŸäŸÑ":"Edit"),9,De),e("button",{onClick:M=>Z(t),class:"delete-btn"},s(l.value?"ÿ≠ÿ∞ŸÅ":"Delete"),9,xe)])]))),128)),I.value.length===0?(r(),n("tr",qe,[e("td",Re,s(l.value?"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨ ŸÖÿ∑ÿßÿ®ŸÇÿ©":"No matching results found"),1)])):v("",!0)])])]))])])):v("",!0),_.value==="levels"?(r(),n("div",Te,[e("div",Fe,[S.value?(r(),n("div",Be,s(l.value?"ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...":"Loading..."),1)):(r(),n("div",Ie,[e("table",Oe,[e("thead",null,[e("tr",null,[e("th",null,s(l.value?"ÿßŸÑÿßÿ≥ŸÖ":"Name"),1),e("th",null,s(l.value?"ÿßŸÑŸàÿµŸÅ":"Description"),1),e("th",null,s(l.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order"),1),e("th",Pe,s(l.value?"ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™":"Actions"),1)])]),e("tbody",null,[(r(!0),n(f,null,b(U.value,t=>(r(),n("tr",{key:t.id},[e("td",null,s(t.name),1),e("td",null,s(t.description),1),e("td",null,s(t.level_order),1),e("td",ze,[e("button",{onClick:M=>se(t),class:"edit-btn"},s(l.value?"ÿ™ÿπÿØŸäŸÑ":"Edit"),9,He)])]))),128))])])]))])])):v("",!0),_.value==="assignments"?(r(),n("div",Qe,[e("div",je,[e("div",Ge,[e("h3",null,s(l.value?"ÿ™ÿπŸäŸäŸÜ ŸÖÿ≥ÿ™ŸàŸâ ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Assign User Level"),1),e("form",{onSubmit:P(le,["prevent"])},[e("div",Je,[e("label",Ke,s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1),d(e("select",{id:"user-select","onUpdate:modelValue":a[7]||(a[7]=t=>$.value=t),required:""},[e("option",We,s(l.value?"ÿßÿÆÿ™ÿ± ŸÖÿ≥ÿ™ÿÆÿØŸÖŸãÿß":"Select a user"),1),(r(!0),n(f,null,b(g.value,t=>(r(),n("option",{key:t.id,value:t.id},s(t.username)+" ("+s(t.user_level!=="None"?t.user_level:l.value?"ÿ∫Ÿäÿ± ŸÖÿπŸäŸÜ":"Not assigned")+") ",9,Xe))),128))],512),[[C,$.value]])]),e("div",Ye,[e("label",Ze,s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Level"),1),d(e("select",{id:"level-select","onUpdate:modelValue":a[8]||(a[8]=t=>A.value=t),required:""},[e("option",es,s(l.value?"ÿßÿÆÿ™ÿ± ŸÖÿ≥ÿ™ŸàŸâ":"Select a level"),1),(r(!0),n(f,null,b(U.value,t=>(r(),n("option",{key:t.id,value:t.level_order},s(t.name)+" ("+s(l.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order")+": "+s(t.level_order)+") ",9,ss))),128))],512),[[C,A.value]])]),e("button",ts,s(l.value?"ÿ™ÿπŸäŸäŸÜ":"Assign"),1)],32)]),e("div",ls,[e("h3",null,s(l.value?"ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Users by Level"),1),(r(!0),n(f,null,b(U.value,t=>(r(),n("div",{key:t.id,class:"level-group"},[e("div",as,[e("h4",null,s(t.name),1),e("span",os,s(H(t.name).length)+" "+s(l.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"users"),1)]),e("ul",ns,[(r(!0),n(f,null,b(H(t.name),M=>(r(),n("li",{key:M.id},s(M.username),1))),128)),H(t.name).length===0?(r(),n("li",rs,s(l.value?"ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ":"No users"),1)):v("",!0)])]))),128))])])])):v("",!0),q.value?(r(),n("div",us,[e("div",is,[e("h2",null,s(l.value?"ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ":"Add New User"),1),e("form",{onSubmit:P(W,["prevent"])},[e("div",ds,[e("label",cs,s(l.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),d(e("input",{type:"text",id:"username","onUpdate:modelValue":a[9]||(a[9]=t=>m.value.username=t),required:""},null,512),[[p,m.value.username]])]),e("div",vs,[e("label",_s,s(l.value?"ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±":"Password"),1),d(e("input",{type:"password",id:"password","onUpdate:modelValue":a[10]||(a[10]=t=>m.value.password=t),required:""},null,512),[[p,m.value.password]])]),e("div",ms,[e("label",hs,s(l.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),d(e("select",{id:"role","onUpdate:modelValue":a[11]||(a[11]=t=>m.value.role=t),required:""},[e("option",ps,s(l.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",fs,s(l.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,m.value.role]])]),e("div",bs,[e("button",{type:"button",onClick:a[12]||(a[12]=t=>q.value=!1),class:"cancel-btn"},s(l.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",ys,s(l.value?"ÿ•ÿ∂ÿßŸÅÿ©":"Add"),1)])],32)])])):v("",!0),R.value?(r(),n("div",gs,[e("div",Us,[e("h2",null,s(l.value?"ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Edit User"),1),e("form",{onSubmit:P(Y,["prevent"])},[e("div",ks,[e("label",ws,s(l.value?"ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ":"Username"),1),d(e("input",{type:"text",id:"edit-username","onUpdate:modelValue":a[13]||(a[13]=t=>h.value.username=t),required:""},null,512),[[p,h.value.username]])]),e("div",Ls,[e("label",Cs,s(l.value?"ÿßŸÑÿØŸàÿ±":"Role"),1),d(e("select",{id:"edit-role","onUpdate:modelValue":a[14]||(a[14]=t=>h.value.role=t),required:""},[e("option",Es,s(l.value?"ŸÖÿØŸäÿ±":"Admin"),1),e("option",Ss,s(l.value?"ŸÖÿ≥ÿ™ÿÆÿØŸÖ":"User"),1)],512),[[C,h.value.role]])]),e("div",$s,[e("button",{type:"button",onClick:a[15]||(a[15]=t=>R.value=!1),class:"cancel-btn"},s(l.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",As,s(l.value?"ÿ≠ŸÅÿ∏":"Save"),1)])],32)])])):v("",!0),F.value?(r(),n("div",Ns,[e("div",Vs,[e("h2",null,s(l.value?"ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ":"Edit Level"),1),e("form",{onSubmit:P(te,["prevent"])},[e("div",Ms,[e("label",Ds,s(l.value?"ÿßŸÑÿßÿ≥ŸÖ":"Name"),1),d(e("input",{type:"text",id:"edit-level-name","onUpdate:modelValue":a[16]||(a[16]=t=>c.value.name=t),required:""},null,512),[[p,c.value.name]])]),e("div",xs,[e("label",qs,s(l.value?"ÿßŸÑŸàÿµŸÅ":"Description"),1),d(e("textarea",{id:"edit-level-description","onUpdate:modelValue":a[17]||(a[17]=t=>c.value.description=t),rows:"3"},null,512),[[p,c.value.description]])]),e("div",Rs,[e("label",Ts,s(l.value?"ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®":"Order"),1),d(e("input",{type:"number",id:"edit-level-order","onUpdate:modelValue":a[18]||(a[18]=t=>c.value.level_order=t)},null,512),[[p,c.value.level_order]])]),e("div",Fs,[e("button",{type:"button",onClick:a[19]||(a[19]=t=>F.value=!1),class:"cancel-btn"},s(l.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",Bs,s(l.value?"ÿ≠ŸÅÿ∏":"Save"),1)])],32)])])):v("",!0),T.value?(r(),n("div",Is,[e("div",Os,[e("h2",null,s(l.value?"ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≠ÿ∞ŸÅ":"Confirm Delete"),1),e("p",null,s(l.value?`ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ "${(w=k.value)==null?void 0:w.username}"ÿü`:`Are you sure you want to delete user "${(O=k.value)==null?void 0:O.username}"?`),1),e("div",Ps,[e("button",{onClick:a[20]||(a[20]=t=>T.value=!1),class:"cancel-btn"},s(l.value?"ÿ•ŸÑÿ∫ÿßÿ°":"Cancel"),1),e("button",{onClick:ee,class:"delete-confirm-btn"},s(l.value?"ÿ≠ÿ∞ŸÅ":"Delete"),1)])])])):v("",!0)],2)}}}),Gs=ue(zs,[["__scopeId","data-v-11a861f2"]]);export{Gs as default};
